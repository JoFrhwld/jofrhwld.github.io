<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.233">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josef Fruehwald">
<meta name="dcterms.date" content="2022-10-03">

<title>Lin517: Natural Language Processing - Evaluating models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../python_sessions/00_session1.html" rel="next">
<link href="../../lectures/word_vectors/01_concept.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Evaluating models</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Lin517: Natural Language Processing</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/reading/index.html" class="sidebar-item-text sidebar-link">Reading a technical paper</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/notation/index.html" class="sidebar-item-text sidebar-link">Mathematical notation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Intro</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/what_is_nlp/index.html" class="sidebar-item-text sidebar-link">What is NLP?</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Data Sparsity and Processing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_sparsity/data_sparsity.html" class="sidebar-item-text sidebar-link">Data Sparsity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_processing/index.html" class="sidebar-item-text sidebar-link">Data processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_processing/addendum.html" class="sidebar-item-text sidebar-link">Data processing – addendum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/lem_stem/index.html" class="sidebar-item-text sidebar-link">Lemmatizing and stemming</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">ngrams</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/index.html" class="sidebar-item-text sidebar-link">ngram Language Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/01-ngram-eval.html" class="sidebar-item-text sidebar-link">ngrams - Perplexity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/02_smoothing.html" class="sidebar-item-text sidebar-link">ngram - Smoothing</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../lectures/word_vectors/index.html" class="sidebar-item-text sidebar-link">Word Vectors</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/word_vectors/01_concept.html" class="sidebar-item-text sidebar-link">Word Vectors - Concepts</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/evaluation/index.html" class="sidebar-item-text sidebar-link active">Evaluating models</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">python sessions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/00_session1.html" class="sidebar-item-text sidebar-link">Starting Python</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/01_session2.html" class="sidebar-item-text sidebar-link">Lists and Dictionaries</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/02_session3.html" class="sidebar-item-text sidebar-link">Loops Etc.</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/03_session4.html" class="sidebar-item-text sidebar-link">Comprehensions and Useful Things</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/04_session5.html" class="sidebar-item-text sidebar-link">Making and Counting Bigrams</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#training-vs-testing" id="toc-training-vs-testing" class="nav-link active" data-scroll-target="#training-vs-testing">Training vs testing</a>
  <ul class="collapse">
  <li><a href="#why-not-train-and-test-on-the-whole-dataset" id="toc-why-not-train-and-test-on-the-whole-dataset" class="nav-link" data-scroll-target="#why-not-train-and-test-on-the-whole-dataset">Why not train and test on the whole dataset?</a></li>
  <li><a href="#bias-vs-variance" id="toc-bias-vs-variance" class="nav-link" data-scroll-target="#bias-vs-variance">Bias vs Variance</a></li>
  <li><a href="#measuring-error-or-loss" id="toc-measuring-error-or-loss" class="nav-link" data-scroll-target="#measuring-error-or-loss">Measuring error (or Loss)</a></li>
  </ul></li>
  <li><a href="#a-linear-model-example" id="toc-a-linear-model-example" class="nav-link" data-scroll-target="#a-linear-model-example">A Linear Model example</a></li>
  <li><a href="#precision-recall-and-f-measure" id="toc-precision-recall-and-f-measure" class="nav-link" data-scroll-target="#precision-recall-and-f-measure">Precision, Recall, and F-Measure</a>
  <ul class="collapse">
  <li><a href="#scenario-1-it-picks-all-of-the-berries" id="toc-scenario-1-it-picks-all-of-the-berries" class="nav-link" data-scroll-target="#scenario-1-it-picks-all-of-the-berries">Scenario 1: It picks all of the berries</a></li>
  <li><a href="#scenario-2-the-robot-picks-only-1-ripe-raspberry" id="toc-scenario-2-the-robot-picks-only-1-ripe-raspberry" class="nav-link" data-scroll-target="#scenario-2-the-robot-picks-only-1-ripe-raspberry">Scenario 2: The robot picks only 1 ripe raspberry</a></li>
  <li><a href="#scenario-3-the-robot-alternates-between-picking-and-not-picking" id="toc-scenario-3-the-robot-alternates-between-picking-and-not-picking" class="nav-link" data-scroll-target="#scenario-3-the-robot-alternates-between-picking-and-not-picking">Scenario 3: The robot alternates between picking and not picking</a></li>
  <li><a href="#a-non-berry-example" id="toc-a-non-berry-example" class="nav-link" data-scroll-target="#a-non-berry-example">A non-berry example</a></li>
  </ul></li>
  <li><a href="#edit-distance" id="toc-edit-distance" class="nav-link" data-scroll-target="#edit-distance">Edit Distance</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Evaluating models</h1>
  <div class="quarto-categories">
    <div class="quarto-category">models</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Josef Fruehwald </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 3, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p>Language Models (<a href="../../lectures/ngram/index.html#language-prediction">including ngram models</a>) are focused on “string prediction”, meaning we need to evaluate them like we would any predictive model. In both statistics and machine learning, there are some conventionalized approaches to this task that we can discuss in general.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
The code
</div>
</div>
<div class="callout-body-container callout-body">
<p>Unless indicated otherwise, the code shown in this lesson is R code. I’m using R code instead of Python, even though Python is the language we’re learning in the course, because I’m more familiar with how to so what I want to show you in R.</p>
</div>
</div>
<section id="training-vs-testing" class="level2">
<h2 class="anchored" data-anchor-id="training-vs-testing">Training vs testing</h2>
<p>The best way to evaluate a prediction model is to see how good its predictions are on some data that you already <em>know</em> what the predictions should be. The workflow, then, is</p>
<ol type="1">
<li>“Train” the model on a training data set.</li>
<li>“Test” the model on a test data set.</li>
</ol>
<p>Now, it’s rarely the case that people collect and curate a large training dataset to train a model, then go out and collect and curate a whole nother test dataset to test the model’s predictions. Instead, what they do is take their original dataset and split it into two pieces: “train” and “test”. Usually, “train” contains most of the data (80% to 90%), while “test” is a smaller held-out dataset (10% to 20% of the data).</p>
<section id="why-not-train-and-test-on-the-whole-dataset" class="level3">
<h3 class="anchored" data-anchor-id="why-not-train-and-test-on-the-whole-dataset">Why not train and test on the whole dataset?</h3>
<p>When the model is “learning” how to make its predictions, the values it learns to make those predictions with will always be dependent on the training data. For example, compare the mini-bigram models below, one based on <em>Frankenstein</em> and the other based on <em>Count of Monte Cristo</em>.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">word</th>
<th style="text-align: left;">next word</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Frankenstein; Or, The Modern Prometheus</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">same</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frankenstein; Or, The Modern Prometheus</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">most</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frankenstein; Or, The Modern Prometheus</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">cottage</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frankenstein; Or, The Modern Prometheus</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">sun</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Frankenstein; Or, The Modern Prometheus</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">first</td>
<td style="text-align: right;">35</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: left;">word</th>
<th style="text-align: left;">next word</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">The Count of Monte Cristo, Illustrated</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">count</td>
<td style="text-align: right;">1107</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Count of Monte Cristo, Illustrated</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">young</td>
<td style="text-align: right;">530</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Count of Monte Cristo, Illustrated</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">same</td>
<td style="text-align: right;">442</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Count of Monte Cristo, Illustrated</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">door</td>
<td style="text-align: right;">410</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Count of Monte Cristo, Illustrated</td>
<td style="text-align: left;">the</td>
<td style="text-align: left;">first</td>
<td style="text-align: right;">295</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>If we used the bigram model trained on <em>Frankenstein</em> to predict the most likely word to come after “the” on <em>Frankenstein</em> itself, we would do pretty well! But if we tried to use it to predict the most likely word to come after “the” in <em>The Count of Monte Cristo</em>, we’d do a lot worse! The highest frequency <code>the w</code> bigram in <em>The Count of Monte Cristo</em> (<code>the count</code>) doesn’t even appear in <em>Frankenstein</em>.</p>
</section>
<section id="bias-vs-variance" class="level3">
<h3 class="anchored" data-anchor-id="bias-vs-variance">Bias vs Variance</h3>
<p>This issue of the predictions of a model being too particularized to training data is related to the concept of the “Bias-Variance Tradeoff”.</p>
<ul>
<li><p>High Bias, Low Variance: One way to think of a high-Bias model is that it “over simplifies” the relationships in the data, but it also means that it will generalize to new data sets in a way that’s comparable to the training set.</p>
<ul>
<li>high-Bias model of morphology: All past tense is formed by adding <em>-ed</em>. This will produce some errors for verbs like <em>run</em>, and <em>go</em>, but will generalize well to new verbs, like <em>yeet</em>.</li>
</ul></li>
<li><p>Low Bias, High Variance: A high-Variance model captures much more detail to the relationships in the data, but that means it might be “overfit” on the training data.</p>
<ul>
<li>high-Variance model of morphology: You just have to memorize every <em>present</em> ➡️ <em>past</em> mapping verb by verb. This won’t any errors on verbs we already know like <em>wait</em>, <em>run</em> or <em>go</em>, but won’t generalize well to new verbs, like <em>yeet</em>.</li>
</ul></li>
</ul>
</section>
<section id="measuring-error-or-loss" class="level3">
<h3 class="anchored" data-anchor-id="measuring-error-or-loss">Measuring error (or Loss)</h3>
<p>Inevitably, the model we’re fitting will make predictions that are wrong, and then we need some way to quantify, or measure, how wrong the predictions were. The specific measure we use is going to depend a lot on the kind of prediction task we have, but some you might have already seen (or will see) are</p>
<ul>
<li><p><strong>M</strong>ean <strong>S</strong>quared <strong>E</strong>rror, or MSE</p></li>
<li><p>Cross Entropy</p></li>
<li><p>F(1) score</p></li>
<li><p>Accuracy</p></li>
<li><p>BLEU score</p></li>
</ul>
<p>Often the numbers these scores put out aren’t meaningful in and of themselves, but rather are used to compare models. But when you see a “score” or a “loss function” mentioned, understand it, generally, to be a measure of the difference between the values we expected in the test set, vs the values the model predicted.</p>
</section>
</section>
<section id="a-linear-model-example" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="a-linear-model-example">A Linear Model example</h2>
<p>As a brief example, let’s look at a data set of body measurements of penguins.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="assets/penguins.png" class="img-fluid figure-img" width="328"></p>
<p></p><figcaption class="figure-caption margin-caption">Artwork by @allison_horst</figcaption><p></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(palmerpenguins<span class="sc">::</span>penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  species island    bill_length_mm bill_depth_mm flipper_l…¹ body_…² sex    year
  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;       &lt;int&gt;   &lt;int&gt; &lt;fct&gt; &lt;int&gt;
1 Adelie  Torgersen           39.1          18.7         181    3750 male   2007
2 Adelie  Torgersen           39.5          17.4         186    3800 fema…  2007
3 Adelie  Torgersen           40.3          18           195    3250 fema…  2007
4 Adelie  Torgersen           NA            NA            NA      NA &lt;NA&gt;   2007
5 Adelie  Torgersen           36.7          19.3         193    3450 fema…  2007
6 Adelie  Torgersen           39.3          20.6         190    3650 male   2007
# … with abbreviated variable names ¹​flipper_length_mm, ²​body_mass_g</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(palmerpenguins<span class="sc">::</span>penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 344</code></pre>
</div>
</div>
<p>We’re going to look at two models that try to predict the bill length of these penguins, one trying to predict it based on body mass, and the other based on bill depth.</p>
<div id="fig-peng1" class="cell quarto-layout-panel page-columns page-full">
<p></p><figcaption>Figure&nbsp;1: Body measurements of penguins</figcaption><p></p>
<figure class="figure page-columns page-full">
<div class="quarto-layout-row quarto-layout-valign-top page-columns page-full">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref page-columns page-full" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-peng1-1" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="index_files/figure-html/fig-peng1-1.png" class="img-fluid figure-img" data-ref-parent="fig-peng1" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">(a) Bill length predicted by body mass</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref page-columns page-full" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-peng1-2" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="index_files/figure-html/fig-peng1-2.png" class="img-fluid figure-img" data-ref-parent="fig-peng1" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">(b) Bill length predicted by bill depth</figcaption><p></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
<p>First, well split the data into train and test sets. I’m going to choose a random 80% of the data to be the training set, and use remaining 20% to be the test set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">517</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>penguins_id <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">row_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> penguins_id <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> penguins_id <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(<span class="sc">!</span>row_id <span class="sc">%in%</span> train<span class="sc">$</span>row_id)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 266</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67</code></pre>
</div>
</div>
<p>Now, I’ll fit two linear models with the training set. The linear model is saying “the predicted bill length for a given predictor (body mass or bill depth) is whatever value is on the line.”</p>
<div id="fig-train" class="quarto-layout-panel">
<p></p><figcaption>Figure&nbsp;2: Models trained on <code>train</code>.</figcaption><p></p>
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="480"></p>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="480"></p>
</div>
</div>
</div>
</figure>
</div>
<p>These are both “High Bias” models. Hardly any of the points are exactly on the lines.</p>
<p>Now, let’s see how well these models perform on the held out test data.\</p>
<div class="cell">

</div>
<div id="fig-test" class="quarto-layout-panel">
<p></p><figcaption>Figure&nbsp;3: Model performance on the test set</figcaption><p></p>
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="480"></p>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="480"></p>
</div>
</div>
</div>
</figure>
</div>
<p>It’s kind of hard to see from just the figures which model performed better on the test set. To evaluate the error, or loss, of these models on the test set, I’ll use the Mean Squared error, which is calculated like so:</p>
<ul>
<li><p>For every data point, subtract the predicted value from the actual value, to get the difference between the prediction and reality.</p></li>
<li><p>Multiply each difference by itself, a.k.a. square it.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p></li>
<li><p>Get the mean of these squared errors.</p></li>
</ul>
<p>In math terms, let’s say</p>
<ul>
<li><p><span class="math inline">\(y_i\)</span> is the <em>actual</em> value of some data point.</p></li>
<li><p><span class="math inline">\(\hat{y}_i\)</span> is the <em>predicted</em> value</p></li>
<li><p><span class="math inline">\(N\)</span> is the total number of data points.</p></li>
</ul>
<p>Then the mean squared error is</p>
<p><span class="math display">\[
\text{MSE} = \frac{\sum_{i=1}^N(y_i-\hat{y}_i)^2}{N}
\]</span></p>
<p>I’ll show you the actual code I’m using to get the MSE, in case it demystifies the mathematical formula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>diff_body        <span class="ot">=</span> test<span class="sc">$</span>bill_length_mm <span class="sc">-</span> test<span class="sc">$</span>body_pred</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>square_diff_body <span class="ot">=</span> diff_body<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>mse_body         <span class="ot">=</span> <span class="fu">mean</span>(square_diff_body)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mse_body)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16.72451</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>diff_bill        <span class="ot">=</span> test<span class="sc">$</span>bill_length_mm <span class="sc">-</span> test<span class="sc">$</span>bill_pred</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>square_diff_bill <span class="ot">=</span> diff_bill<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mse_bill         <span class="ot">=</span> <span class="fu">mean</span>(square_diff_bill)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mse_bill)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26.83769</code></pre>
</div>
</div>
<p>It looks like the model predicting bill length using body mass has a smaller MSE than the model predicting bill length using bill depth. So if we had to choose between these two models, we’d go with the body mass model.</p>
</section>
<section id="precision-recall-and-f-measure" class="level2">
<h2 class="anchored" data-anchor-id="precision-recall-and-f-measure">Precision, Recall, and F-Measure</h2>
<p>For NLP tasks, we’re not usually trying to predict a continuous measure, but rather trying to categorize words, sentences, or documents. In these kinds of tasks, when we evalulate a model, we’ll often want to use measures known as “Precision”, “Recall” and “F-measure”.</p>
<p>To illustrate these measures, let’s say we’ve built a robot to pick raspberries, and we want it to pick all of the ripe berries (if we leave any behind, they’ll rot!) and none of the unripe berries (if we pick them before they’re ripe, we’ve missed out on future berries!). Let’s present the robot with this following scene that has 9 berries in the foreground. 5 of them are ripe and 4 of them are unripe.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/raspberries.jpeg" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<section id="scenario-1-it-picks-all-of-the-berries" class="level3">
<h3 class="anchored" data-anchor-id="scenario-1-it-picks-all-of-the-berries">Scenario 1: It picks all of the berries</h3>
<p>Let’s say the robot picked all of the berries.</p>
<table class="table">
<thead>
<tr class="header">
<th>Picked</th>
<th>Unpicked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="unripe">unripe berry</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="unripe">unripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="unripe">unripe berry</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="unripe">unripe berry</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>This strategy has high “Recall”. There were a total of 5 ripe berries, and the robot picked all 5 of them.</p>
<p><span class="math display">\[
\text{recall} = \frac{\text{ripe picked berries}}{\text{ripe berries}} = \frac{5}{5} = 1
\]</span> But, it has low “precision”. Of all the berries it picked, a lot of them were unripe.</p>
<p><span class="math display">\[
\text{precision} = \frac{\text{ripe picked berries}}{\text{picked berries}} = \frac{5}{9} = 0.55
\]</span></p>
<p>The “F-measure” or “F1 score” is a way to combine the precision and recall score into one overall performance score.</p>
<p><span class="math display">\[
F_1 = 2\frac{\text{precision}\times \text{recall}}{\text{precision} + \text{recall}}=2\frac{0.55\times 1}{0.55 + 1}=2\frac{0.55}{1.55} = 0.71
\]</span></p>
</section>
<section id="scenario-2-the-robot-picks-only-1-ripe-raspberry" class="level3">
<h3 class="anchored" data-anchor-id="scenario-2-the-robot-picks-only-1-ripe-raspberry">Scenario 2: The robot picks only 1 ripe raspberry</h3>
<table class="table">
<thead>
<tr class="header">
<th>Picked</th>
<th>Unpicked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><span class="ripe">ripe berry</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="ripe">ripe berry</span></td>
</tr>
<tr class="even">
<td></td>
<td><span class="ripe">ripe berry</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="ripe">ripe berry</span></td>
</tr>
<tr class="even">
<td></td>
<td><span class="unripe">unripe berry</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="unripe">unripe berry</span></td>
</tr>
<tr class="even">
<td></td>
<td><span class="unripe">unripe berry</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="unripe">unripe berry</span></td>
</tr>
</tbody>
</table>
<p>This strategy has a very low recall. There are 5 ripe berries, and it has only picked 1 of them</p>
<p><span class="math display">\[
\text{recall} = \frac{\text{ripe picked berries}}{\text{ripe berries}} = \frac{1}{5} = 0.2
\]</span> <em>But</em>, it has an extremely high precision. Of all of the berries it picked, it <em>only</em> picked ripe ones!</p>
<p><span class="math display">\[
\text{precision} = \frac{\text{ripe picked berries}}{\text{picked berries}} = \frac{1}{1} = 1
\]</span> The very low precision winds up dragging down the overall F-measure. <span class="math display">\[
F_1 = 2\frac{\text{precision}\times \text{recall}}{\text{precision} + \text{recall}}=2\frac{1 \times 0.2}{1 + 0.2}=2\frac{0.2}{1.2} = 0.33
\]</span></p>
</section>
<section id="scenario-3-the-robot-alternates-between-picking-and-not-picking" class="level3">
<h3 class="anchored" data-anchor-id="scenario-3-the-robot-alternates-between-picking-and-not-picking">Scenario 3: The robot alternates between picking and not picking</h3>
<table class="table">
<thead>
<tr class="header">
<th>Picked</th>
<th>Unpicked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><span class="ripe">ripe berry</span></td>
</tr>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><span class="ripe">ripe berry</span></td>
</tr>
<tr class="odd">
<td><span class="ripe">ripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><span class="unripe">unripe berry</span></td>
</tr>
<tr class="odd">
<td><span class="unripe">unripe berry</span></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><span class="unripe">unripe berry</span></td>
</tr>
<tr class="odd">
<td><span class="unripe">unripe berry</span></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\text{recall} = \frac{\text{ripe picked berries}}{\text{ripe berries}} = \frac{3}{5} = 0.6
\]</span></p>
<p><span class="math display">\[
\text{precision} = \frac{\text{ripe picked berries}}{\text{picked berries}} = \frac{3}{5} = 0.6
\]</span></p>
<p><span class="math display">\[
F_1 = 2\frac{\text{precision}\times \text{recall}}{\text{precision} + \text{recall}}=2\frac{0.6 \times 0.6}{0.6 + 0.6}=2\frac{0.36}{1.2} = 0.6
\]</span></p>
</section>
<section id="a-non-berry-example" class="level3">
<h3 class="anchored" data-anchor-id="a-non-berry-example">A non-berry example</h3>
<p>One kind of NLP task is “<strong>N</strong>amed <strong>E</strong>ntity <strong>R</strong>ecognition” (NER), or detecting and identifying the kind of named entities in a text. Here’s an example of <code>spaCy</code> doing that with a the sentence</p>
<blockquote class="blockquote">
<p>Dr.&nbsp;Josef Fruehwald is teaching Lin517 at the University of Kentucky in the Fall 2022 semester.</p>
</blockquote>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># python</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> spacy <span class="im">import</span> displacy</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Dr. Josef Fruehwald is teaching Lin517 at the University of Kentucky in the Fall 2022 semester."</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>doc <span class="op">=</span> nlp(text)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(displacy.render(doc, style <span class="op">=</span> <span class="st">'ent'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="entities" style="line-height: 2.5; direction: ltr">
Dr.&nbsp; <mark class="entity" style="background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;"> Josef Fruehwald <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">PERSON</span> </mark> is teaching <mark class="entity" style="background: #feca74; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;"> Lin517 <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">GPE</span> </mark> at <mark class="entity" style="background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;"> the University of Kentucky <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">ORG</span> </mark> in the Fall <mark class="entity" style="background: #bfe1d9; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;"> 2022 <span style="font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem">DATE</span> </mark> semester.
</div>
<p>When looking at the original sentence, we could think of each word, or span of words, as a berry, and the named entities as the ripe berries. The precision and recall here would be</p>
<p><span class="math display">\[
\text{precision}=\frac{\text{named entitites identified}}{\text{identified words}}
\]</span></p>
<p><span class="math display">\[
\text{recall}=\frac{\text{named entities identified}}{\text{named entities}}
\]</span></p>
<p>In this example, additional adjustments might need to be made for whether the <em>span</em> of the named entities is correct. <code>2022</code> is correctly a date, but maybe <code>Fall</code> should be included in its span. Also, it has identified <code>Lin517</code> as a <strong>G</strong>eo<strong>P</strong>olitical <strong>E</strong>ntity (GPE).</p>
</section>
</section>
<section id="edit-distance" class="level2">
<h2 class="anchored" data-anchor-id="edit-distance">Edit Distance</h2>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The point of doing this is to get a measure that is always positive. If for one data point actual-predicted = 2, then squaring it gets <span class="math inline">\(2^2=4\)</span>. If another data point had an error of the same size, but in the opposite direction, then actual-predicted=-2, and squaring it gets us <span class="math inline">\(-2^2=4\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lectures/word_vectors/01_concept.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Word Vectors - Concepts</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../python_sessions/00_session1.html" class="pagination-link">
        <span class="nav-page-text">Starting Python</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.233">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josef Fruehwald">
<meta name="dcterms.date" content="2022-09-28">
<meta name="description" content="ngram langauge model notes. The structure of these notes broadly follows SLP V3.">

<title>Lin517: Natural Language Processing - ngram Language Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../lectures/ngram/01-ngram-eval.html" rel="next">
<link href="../../lectures/lem_stem/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">ngram Language Models</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Lin517: Natural Language Processing</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/reading/index.html" class="sidebar-item-text sidebar-link">Reading a technical paper</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/notation/index.html" class="sidebar-item-text sidebar-link">Mathematical notation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Intro</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/what_is_nlp/index.html" class="sidebar-item-text sidebar-link">What is NLP?</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Data Sparsity and Processing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_sparsity/data_sparsity.html" class="sidebar-item-text sidebar-link">Data Sparsity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_processing/index.html" class="sidebar-item-text sidebar-link">Data processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_processing/addendum.html" class="sidebar-item-text sidebar-link">Data processing – addendum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/lem_stem/index.html" class="sidebar-item-text sidebar-link">Lemmatizing and stemming</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">ngrams</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/index.html" class="sidebar-item-text sidebar-link active">ngram Language Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/01-ngram-eval.html" class="sidebar-item-text sidebar-link">ngrams - Perplexity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/02_smoothing.html" class="sidebar-item-text sidebar-link">ngram - Smoothing</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../lectures/word_vectors/index.html" class="sidebar-item-text sidebar-link">Word Vectors</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/word_vectors/01_concept.html" class="sidebar-item-text sidebar-link">Word Vectors - Concepts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/word_vectors/02_vectors_examples.html" class="sidebar-item-text sidebar-link">Term-Document and Term-Context matrices</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/word_vectors/03_word2vec.html" class="sidebar-item-text sidebar-link">word2vec</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/evaluation/index.html" class="sidebar-item-text sidebar-link">Evaluating models</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">python sessions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/00_session1.html" class="sidebar-item-text sidebar-link">Starting Python</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/01_session2.html" class="sidebar-item-text sidebar-link">Lists and Dictionaries</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/02_session3.html" class="sidebar-item-text sidebar-link">Loops Etc.</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/03_session4.html" class="sidebar-item-text sidebar-link">Comprehensions and Useful Things</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/04_session5.html" class="sidebar-item-text sidebar-link">Making and Counting Bigrams</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#language-prediction" id="toc-language-prediction" class="nav-link active" data-scroll-target="#language-prediction">Language Prediction</a></li>
  <li><a href="#using-context-ngrams" id="toc-using-context-ngrams" class="nav-link" data-scroll-target="#using-context-ngrams">Using context (ngrams)</a>
  <ul class="collapse">
  <li><a href="#data-sparsity-rears-its-head" id="toc-data-sparsity-rears-its-head" class="nav-link" data-scroll-target="#data-sparsity-rears-its-head">Data Sparsity rears its head</a></li>
  <li><a href="#building-up-a-bigram-model" id="toc-building-up-a-bigram-model" class="nav-link" data-scroll-target="#building-up-a-bigram-model">Building up a bigram model</a></li>
  </ul></li>
  <li><a href="#the-probability-of-a-sentence" id="toc-the-probability-of-a-sentence" class="nav-link" data-scroll-target="#the-probability-of-a-sentence">The probability of a sentence</a>
  <ul class="collapse">
  <li><a href="#larger-ngrams" id="toc-larger-ngrams" class="nav-link" data-scroll-target="#larger-ngrams">Larger ngrams</a></li>
  </ul></li>
  <li><a href="#generating-text" id="toc-generating-text" class="nav-link" data-scroll-target="#generating-text">Generating text</a></li>
  <li><a href="#sparsity-again" id="toc-sparsity-again" class="nav-link" data-scroll-target="#sparsity-again">Sparsity, again</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">ngram Language Models</h1>
  <div class="quarto-categories">
    <div class="quarto-category">ngram</div>
  </div>
  </div>

<div>
  <div class="description">
    ngram langauge model notes. The structure of these notes broadly follows SLP V3.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Josef Fruehwald </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<div class="cell">

</div>
<p>I’m going to split up the “ngram model” materials into explaining how they work in principle, vs the how we have to make engineering decisions to make them work in reality.</p>
<section id="language-prediction" class="level2">
<h2 class="anchored" data-anchor-id="language-prediction">Language Prediction</h2>
<p>When we are perceiving language, we are constantly and in real-time making predictions about what we are about to hear next. While we’re going to be talking about this in terms of predicting the next word, It’s been shown that we do this even partway through a word <span class="citation" data-cites="allopenna1998">(<a href="#ref-allopenna1998" role="doc-biblioref">Allopenna, Magnuson, and Tanenhaus 1998</a>)</span>.</p>
<p>So, let’s say I spoke this much of a sentence to you:</p>
<blockquote class="blockquote">
<p>I could tell he was angry from the tone of his___</p>
</blockquote>
<p>And then a sudden noise obscured the final word, and you only caught part of it. Which of the following three words was I <em>probably</em> trying to say?</p>
<ol type="a">
<li>boys</li>
<li>choice</li>
<li>voice</li>
</ol>
<p>Your ability to guess which word it was is based on your i) experience with English turns of phrase and ii) the information in the context.</p>
<p>One goal of Language Models is to assign probabilities across the vocabulary for what the next word will be, and hopefully assign higher probabilities to the “correct” answer than the “incorrect” answer. Applications for this kind of prediction range from speech-to-text (which could suffer from a very similar circumstance as the fictional one above) to autocomplete or spellcheck.</p>
</section>
<section id="using-context-ngrams" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="using-context-ngrams">Using context (ngrams)</h2>
<p>In the example sentence above, one way we could go about trying to predict which word is most likely is to count up how many times the phrase “I could tell he was angry from the tone of his___” is finished by the candidate words. Here’s a table of google hits for the three possible phrases, as well as all hits for just the context phrase.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">“I could tell he was angry from the tone of his”</th>
<th style="text-align: right;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">boys</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">choice</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">voice</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>“I could tell he was angry from the tone of his”</em></td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
<p>We’re going to start diving into mathematical formulas now (fortunately the numbers are easy right now).</p>
<p>To represent the count of a word or string of words in a corpus. We’ll use <span class="math inline">\(C(\text{word})\)</span>. So given the table above we have</p>
<p><span class="math display">\[
\displaylines{C(\text{I could tell he was angry from the tone of his})=3\\
C(\text{I could tell he was angry from the tone of his boys})=0\\
C(\text{I could tell he was angry from the tone of his choice})=0\\
C(\text{I could tell he was angry from the tone of his voice})=3}
\]</span></p>
<p>To describe the probability that the next word is “choice” given that we’ve already heard “I could tell he was angry from the tone of his”, we’ll use the notation <span class="math inline">\(P(\text{choice} | \text{I could tell he was angry from the tone of his})\)</span>. To <em>calculate</em> that probability, we’ll divide the total count of the whole phrase by the count of the preceding context.</p>
<p><span class="math display">\[
P(\text{choice} | \text{I could tell he was angry from the tone of his}) = \frac{C(\text{I could tell he was angry by the tone of his choice})}{C(\text{I could tell he was angry by the tone of his})} = \frac{0}{3} = 0
\]</span></p>
<p>In fact, we can estimate the probability of an entire sentence with the <em>Probability Chain Rule</em>. The probability of a sequence of events like <span class="math inline">\(P(X_1X_2X_3)\)</span> can be estimated by multiplying out their conditional probabilities like so:</p>
<p><span class="math display">\[
P(X_1X_2X_3) = P(X_1)P(X_2|X_1)P(X_3|X_1X_2)
\]</span></p>
<p>Or, to use a phrase as an example:<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p><span class="math display">\[
P(\text{du hast mich gefragt})=P(\text{du})P(\text{hast}|\text{du})P(\text{mich}|\text{du hast})P(\text{gefragt}|\text{du hast mich})
\]</span></p>
<section id="data-sparsity-rears-its-head" class="level3">
<h3 class="anchored" data-anchor-id="data-sparsity-rears-its-head">Data Sparsity rears its head</h3>
<p>The problem with <a href="../../lectures/data_sparsity/data_sparsity.html">data sparsity</a> rears its head, though. As we can already see in the table above, long phrases, although <em>possible</em>, might not appear in any corpus, giving us a very unreliable probability estimate.</p>
<p>Instead of using the <em>whole</em> history, we can use a smaller context in a more strictly defined window. So, instead of looking at the whole sentence, what if we looked at counts of just “of his” from the example sentence.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">“of his”</th>
<th style="text-align: right;">count (in millions)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">boys</td>
<td style="text-align: right;">2.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">choice</td>
<td style="text-align: right;">14.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">voice</td>
<td style="text-align: right;">44.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">“of his”</td>
<td style="text-align: right;">2,400.0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\displaylines{
P(\text{boys} | \text{of his}) = \frac{C(\text{of his boys)}}{C(\text{of his})}=\frac{2.2}{2400} = 0.0009\\
P({\text{choice}|\text{of his}})= \frac{C(\text{of his choice)}}{C(\text{of his})}=\frac{14.2}{2400} = 0.005\\
P({\text{voice}|\text{of his}})= \frac{C(\text{of his voice)}}{C(\text{of his})}=\frac{44.5}{2400} = 0.018}
\]</span></p>
<p>The continuation “voice” here is still <em>relatively</em> low probability, but has the highest probability of our candidate set.</p>
<p>This is the basic approach of an ngram model. Instead of using all available words to calculate the probability of the next word, we’ll approximate it with a smaller window. The example in the table above is a “trigram” model.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
“gram” names
</div>
</div>
<div class="callout-body-container callout-body">
<dl>
<dt>unigram:</dt>
<dd>
<p>Counting up every individual (1) word, and try to estimate the probability of word in isolation.</p>
</dd>
<dt>bigram:</dt>
<dd>
<p>Count up every sequence of two words, and try to estimate the probability of a word given just one word before it,</p>
</dd>
<dt>trigram</dt>
<dd>
<p>Count up every sequence of three words, and try to estimate the probability of a word given just the two words before it.</p>
</dd>
</dl>
<p>“Trigrams” are the last n-gram with a special name. The rest are just called “4-gram” or “5-gram”.</p>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="building-up-a-bigram-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="building-up-a-bigram-model">Building up a bigram model</h3>
<p>Let’s look at what happens as we gradually build up a bigram model we’ll start with one sentence.</p>
<pre><code>I saw the dog</code></pre>
<div class="cell">

</div>
<div class="cell" data-file="figure/1sent.dot">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 584.01 44.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-40 580.01,-40 580.01,4 -4,4"></polygon> <!-- dog --> <g id="node1" class="node">
<title>
dog
</title>
<ellipse fill="none" stroke="black" cx="444.24" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="444.24" y="-13.8" font-family="Times,serif" font-size="14.00">dog</text> </g> <!-- END --> <g id="node2" class="node">
<title>
END
</title>
<ellipse fill="none" stroke="black" cx="545.12" cy="-18" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="545.12" y="-13.8" font-family="Times,serif" font-size="14.00">END</text> </g> <!-- dog&#45;&gt;END --> <g id="edge1" class="edge">
<title>
dog-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M471.48,-18C481.37,-18 492.85,-18 503.73,-18"></path> <polygon fill="black" stroke="black" stroke-width="6" points="503.91,-23.25 513.91,-18 503.91,-12.75 503.91,-23.25"></polygon> <text text-anchor="middle" x="492.74" y="-22.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- I --> <g id="node3" class="node">
<title>
I
</title>
<ellipse fill="none" stroke="black" cx="153.24" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="153.24" y="-13.8" font-family="Times,serif" font-size="14.00">I</text> </g> <!-- saw --> <g id="node4" class="node">
<title>
saw
</title>
<ellipse fill="none" stroke="black" cx="250.24" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="250.24" y="-13.8" font-family="Times,serif" font-size="14.00">saw</text> </g> <!-- I&#45;&gt;saw --> <g id="edge2" class="edge">
<title>
I-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M180.45,-18C190.52,-18 202.2,-18 213.05,-18"></path> <polygon fill="black" stroke="black" stroke-width="6" points="213.11,-23.25 223.11,-18 213.11,-12.75 213.11,-23.25"></polygon> <text text-anchor="middle" x="201.74" y="-22.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- the --> <g id="node5" class="node">
<title>
the
</title>
<ellipse fill="none" stroke="black" cx="347.24" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="347.24" y="-13.8" font-family="Times,serif" font-size="14.00">the</text> </g> <!-- saw&#45;&gt;the --> <g id="edge3" class="edge">
<title>
saw-&gt;the
</title>
<path fill="none" stroke="black" stroke-width="6" d="M277.45,-18C287.52,-18 299.2,-18 310.05,-18"></path> <polygon fill="black" stroke="black" stroke-width="6" points="310.11,-23.25 320.11,-18 310.11,-12.75 310.11,-23.25"></polygon> <text text-anchor="middle" x="298.74" y="-22.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- the&#45;&gt;dog --> <g id="edge5" class="edge">
<title>
the-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M374.45,-18C384.52,-18 396.2,-18 407.05,-18"></path> <polygon fill="black" stroke="black" stroke-width="6" points="407.11,-23.25 417.11,-18 407.11,-12.75 407.11,-23.25"></polygon> <text text-anchor="middle" x="395.74" y="-22.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- START --> <g id="node6" class="node">
<title>
START
</title>
<ellipse fill="none" stroke="black" cx="41.62" cy="-18" rx="41.74" ry="18"></ellipse> <text text-anchor="middle" x="41.62" y="-13.8" font-family="Times,serif" font-size="14.00">START</text> </g> <!-- START&#45;&gt;I --> <g id="edge4" class="edge">
<title>
START-&gt;I
</title>
<path fill="none" stroke="black" stroke-width="6" d="M83.44,-18C94.12,-18 105.56,-18 115.99,-18"></path> <polygon fill="black" stroke="black" stroke-width="6" points="116.01,-23.25 126.01,-18 116.01,-12.75 116.01,-23.25"></polygon> <text text-anchor="middle" x="104.74" y="-22.2" font-family="Times,serif" font-size="14.00">1</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<pre><code>I saw the dog
We saw a dog</code></pre>
<div class="cell">

</div>
<div class="cell" data-file="figure/2sent.dot">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 605.01 99.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 95)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-95 601.01,-95 601.01,4 -4,4"></polygon> <!-- a --> <g id="node1" class="node">
<title>
a
</title>
<ellipse fill="none" stroke="black" cx="368.24" cy="-73" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="368.24" y="-68.8" font-family="Times,serif" font-size="14.00">a</text> </g> <!-- dog --> <g id="node2" class="node">
<title>
dog
</title>
<ellipse fill="none" stroke="black" cx="465.24" cy="-46" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="465.24" y="-41.8" font-family="Times,serif" font-size="14.00">dog</text> </g> <!-- a&#45;&gt;dog --> <g id="edge1" class="edge">
<title>
a-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M393.7,-66.05C404.87,-62.87 418.28,-59.06 430.39,-55.62"></path> <polygon fill="black" stroke="black" stroke-width="6" points="432,-60.62 440.19,-52.84 429.13,-50.52 432,-60.62"></polygon> <text text-anchor="middle" x="416.74" y="-65.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- END --> <g id="node3" class="node">
<title>
END
</title>
<ellipse fill="none" stroke="black" cx="566.12" cy="-46" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="566.12" y="-41.8" font-family="Times,serif" font-size="14.00">END</text> </g> <!-- dog&#45;&gt;END --> <g id="edge2" class="edge">
<title>
dog-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M492.48,-46C502.37,-46 513.85,-46 524.73,-46"></path> <polygon fill="black" stroke="black" stroke-width="6" points="524.91,-51.25 534.91,-46 524.91,-40.75 524.91,-51.25"></polygon> <text text-anchor="middle" x="513.74" y="-50.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- I --> <g id="node4" class="node">
<title>
I
</title>
<ellipse fill="none" stroke="black" cx="163.74" cy="-72" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="163.74" y="-67.8" font-family="Times,serif" font-size="14.00">I</text> </g> <!-- saw --> <g id="node5" class="node">
<title>
saw
</title>
<ellipse fill="none" stroke="black" cx="260.74" cy="-46" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="260.74" y="-41.8" font-family="Times,serif" font-size="14.00">saw</text> </g> <!-- I&#45;&gt;saw --> <g id="edge3" class="edge">
<title>
I-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M189.2,-65.3C200.29,-62.27 213.57,-58.63 225.61,-55.34"></path> <polygon fill="black" stroke="black" stroke-width="6" points="227.1,-60.38 235.36,-52.67 224.33,-50.25 227.1,-60.38"></polygon> <text text-anchor="middle" x="212.24" y="-64.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- saw&#45;&gt;a --> <g id="edge4" class="edge">
<title>
saw-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="3" d="M286.21,-52.26C300.06,-55.81 317.6,-60.3 332.81,-64.19"></path> <polygon fill="black" stroke="black" stroke-width="3" points="332.35,-67.68 342.9,-66.77 334.08,-60.9 332.35,-67.68"></polygon> <text text-anchor="middle" x="314.49" y="-66.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- the --> <g id="node6" class="node">
<title>
the
</title>
<ellipse fill="none" stroke="black" cx="368.24" cy="-19" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="368.24" y="-14.8" font-family="Times,serif" font-size="14.00">the</text> </g> <!-- saw&#45;&gt;the --> <g id="edge5" class="edge">
<title>
saw-&gt;the
</title>
<path fill="none" stroke="black" stroke-width="3" d="M286.21,-39.74C300.06,-36.19 317.6,-31.7 332.81,-27.81"></path> <polygon fill="black" stroke="black" stroke-width="3" points="334.08,-31.1 342.9,-25.23 332.35,-24.32 334.08,-31.1"></polygon> <text text-anchor="middle" x="314.49" y="-39.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- the&#45;&gt;dog --> <g id="edge8" class="edge">
<title>
the-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M393.7,-25.95C404.87,-29.13 418.28,-32.94 430.39,-36.38"></path> <polygon fill="black" stroke="black" stroke-width="6" points="429.13,-41.48 440.19,-39.16 432,-31.38 429.13,-41.48"></polygon> <text text-anchor="middle" x="416.74" y="-38.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- START --> <g id="node7" class="node">
<title>
START
</title>
<ellipse fill="none" stroke="black" cx="41.62" cy="-45" rx="41.74" ry="18"></ellipse> <text text-anchor="middle" x="41.62" y="-40.8" font-family="Times,serif" font-size="14.00">START</text> </g> <!-- START&#45;&gt;I --> <g id="edge6" class="edge">
<title>
START-&gt;I
</title>
<path fill="none" stroke="black" stroke-width="3" d="M78.99,-53.17C94.47,-56.65 112.46,-60.7 127.79,-64.14"></path> <polygon fill="black" stroke="black" stroke-width="3" points="127.38,-67.64 137.91,-66.42 128.92,-60.81 127.38,-67.64"></polygon> <text text-anchor="middle" x="109.99" y="-66.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- We --> <g id="node8" class="node">
<title>
We
</title>
<ellipse fill="none" stroke="black" cx="163.74" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="163.74" y="-13.8" font-family="Times,serif" font-size="14.00">We</text> </g> <!-- START&#45;&gt;We --> <g id="edge7" class="edge">
<title>
START-&gt;We
</title>
<path fill="none" stroke="black" stroke-width="3" d="M78.99,-36.83C94.47,-33.35 112.46,-29.3 127.79,-25.86"></path> <polygon fill="black" stroke="black" stroke-width="3" points="128.92,-29.19 137.91,-23.58 127.38,-22.36 128.92,-29.19"></polygon> <text text-anchor="middle" x="109.99" y="-36.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- We&#45;&gt;saw --> <g id="edge9" class="edge">
<title>
We-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M188.71,-25.07C199.96,-28.38 213.57,-32.39 225.85,-36.01"></path> <polygon fill="black" stroke="black" stroke-width="6" points="224.7,-41.15 235.78,-38.94 227.67,-31.07 224.7,-41.15"></polygon> <text text-anchor="middle" x="212.24" y="-37.2" font-family="Times,serif" font-size="14.00">1</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<pre><code>I saw the dog
We saw a dog
I read a book</code></pre>
<div class="cell">

</div>
<div class="cell" data-file="figure/3sent.dot">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 641.01 124.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-120 637.01,-120 637.01,4 -4,4"></polygon> <!-- a --> <g id="node1" class="node">
<title>
a
</title>
<ellipse fill="none" stroke="black" cx="387.05" cy="-85" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="387.05" y="-80.8" font-family="Times,serif" font-size="14.00">a</text> </g> <!-- book --> <g id="node2" class="node">
<title>
book
</title>
<ellipse fill="none" stroke="black" cx="497.9" cy="-98" rx="30.2" ry="18"></ellipse> <text text-anchor="middle" x="497.9" y="-93.8" font-family="Times,serif" font-size="14.00">book</text> </g> <!-- a&#45;&gt;book --> <g id="edge1" class="edge">
<title>
a-&gt;book
</title>
<path fill="none" stroke="black" stroke-width="3" d="M413.84,-88.08C426.89,-89.64 443.02,-91.57 457.57,-93.3"></path> <polygon fill="black" stroke="black" stroke-width="3" points="457.49,-96.82 467.83,-94.53 458.32,-89.87 457.49,-96.82"></polygon> <text text-anchor="middle" x="440.8" y="-96.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- dog --> <g id="node3" class="node">
<title>
dog
</title>
<ellipse fill="none" stroke="black" cx="497.9" cy="-44" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="497.9" y="-39.8" font-family="Times,serif" font-size="14.00">dog</text> </g> <!-- a&#45;&gt;dog --> <g id="edge2" class="edge">
<title>
a-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="3" d="M410.87,-76.41C426.39,-70.56 447.18,-62.73 464.43,-56.23"></path> <polygon fill="black" stroke="black" stroke-width="3" points="465.98,-59.38 474.11,-52.58 463.52,-52.83 465.98,-59.38"></polygon> <text text-anchor="middle" x="440.8" y="-72.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- END --> <g id="node4" class="node">
<title>
END
</title>
<ellipse fill="none" stroke="black" cx="602.13" cy="-71" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="602.13" y="-66.8" font-family="Times,serif" font-size="14.00">END</text> </g> <!-- book&#45;&gt;END --> <g id="edge3" class="edge">
<title>
book-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M526.03,-90.84C537.6,-87.78 551.3,-84.16 563.81,-80.86"></path> <polygon fill="black" stroke="black" stroke-width="6" points="565.19,-85.92 573.52,-78.29 562.51,-75.77 565.19,-85.92"></polygon> <text text-anchor="middle" x="549.75" y="-89.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- dog&#45;&gt;END --> <g id="edge4" class="edge">
<title>
dog-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M523.38,-50.47C535.44,-53.65 550.23,-57.56 563.66,-61.1"></path> <polygon fill="black" stroke="black" stroke-width="6" points="562.59,-66.25 573.6,-63.73 565.27,-56.1 562.59,-66.25"></polygon> <text text-anchor="middle" x="549.75" y="-62.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- I --> <g id="node5" class="node">
<title>
I
</title>
<ellipse fill="none" stroke="black" cx="170.74" cy="-72" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="170.74" y="-67.8" font-family="Times,serif" font-size="14.00">I</text> </g> <!-- read --> <g id="node6" class="node">
<title>
read
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-98" rx="27.81" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-93.8" font-family="Times,serif" font-size="14.00">read</text> </g> <!-- I&#45;&gt;read --> <g id="edge5" class="edge">
<title>
I-&gt;read
</title>
<path fill="none" stroke="black" stroke-width="3" d="M196.36,-78.03C210.1,-81.39 227.44,-85.64 242.6,-89.35"></path> <polygon fill="black" stroke="black" stroke-width="3" points="242.12,-92.84 252.67,-91.82 243.79,-86.04 242.12,-92.84"></polygon> <text text-anchor="middle" x="224.49" y="-90.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- saw --> <g id="node7" class="node">
<title>
saw
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-31" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-26.8" font-family="Times,serif" font-size="14.00">saw</text> </g> <!-- I&#45;&gt;saw --> <g id="edge6" class="edge">
<title>
I-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="3" d="M194.51,-63.2C209.34,-57.48 228.93,-49.91 245.38,-43.56"></path> <polygon fill="black" stroke="black" stroke-width="3" points="247.09,-46.65 255.16,-39.78 244.57,-40.12 247.09,-46.65"></polygon> <text text-anchor="middle" x="224.49" y="-58.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- read&#45;&gt;a --> <g id="edge7" class="edge">
<title>
read-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="6" d="M306.13,-94.79C319.37,-93.17 335.64,-91.17 350.03,-89.41"></path> <polygon fill="black" stroke="black" stroke-width="6" points="350.82,-94.6 360.11,-88.18 349.54,-84.18 350.82,-94.6"></polygon> <text text-anchor="middle" x="333.3" y="-96.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- saw&#45;&gt;a --> <g id="edge8" class="edge">
<title>
saw-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="3" d="M300.87,-41.67C316.57,-49.66 338.28,-60.7 355.85,-69.64"></path> <polygon fill="black" stroke="black" stroke-width="3" points="354.62,-72.94 365.12,-74.35 357.79,-66.7 354.62,-72.94"></polygon> <text text-anchor="middle" x="333.3" y="-65.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- the --> <g id="node8" class="node">
<title>
the
</title>
<ellipse fill="none" stroke="black" cx="387.05" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="387.05" y="-13.8" font-family="Times,serif" font-size="14.00">the</text> </g> <!-- saw&#45;&gt;the --> <g id="edge9" class="edge">
<title>
saw-&gt;the
</title>
<path fill="none" stroke="black" stroke-width="3" d="M303.78,-23.56C310.44,-21.8 317.72,-20.15 324.55,-19.2 332.65,-18.07 341.42,-17.5 349.72,-17.27"></path> <polygon fill="black" stroke="black" stroke-width="3" points="349.95,-20.77 359.9,-17.14 349.86,-13.77 349.95,-20.77"></polygon> <text text-anchor="middle" x="333.3" y="-24.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- the&#45;&gt;dog --> <g id="edge12" class="edge">
<title>
the-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M414.14,-15.88C425.21,-15.65 438.17,-16.28 449.55,-19.2 456.04,-20.86 462.63,-23.56 468.75,-26.58"></path> <polygon fill="black" stroke="black" stroke-width="6" points="466.61,-31.39 477.91,-31.48 471.57,-22.13 466.61,-31.39"></polygon> <text text-anchor="middle" x="440.8" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- START --> <g id="node9" class="node">
<title>
START
</title>
<ellipse fill="none" stroke="black" cx="41.62" cy="-45" rx="41.74" ry="18"></ellipse> <text text-anchor="middle" x="41.62" y="-40.8" font-family="Times,serif" font-size="14.00">START</text> </g> <!-- START&#45;&gt;I --> <g id="edge10" class="edge">
<title>
START-&gt;I
</title>
<path fill="none" stroke="black" stroke-width="4" d="M79.39,-52.81C96.76,-56.5 117.39,-60.88 134.55,-64.53"></path> <polygon fill="black" stroke="black" stroke-width="4" points="134.22,-68.03 144.73,-66.69 135.67,-61.19 134.22,-68.03"></polygon> <text text-anchor="middle" x="113.49" y="-66.2" font-family="Times,serif" font-size="14.00">0.67</text> </g> <!-- We --> <g id="node10" class="node">
<title>
We
</title>
<ellipse fill="none" stroke="black" cx="170.74" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="170.74" y="-13.8" font-family="Times,serif" font-size="14.00">We</text> </g> <!-- START&#45;&gt;We --> <g id="edge11" class="edge">
<title>
START-&gt;We
</title>
<path fill="none" stroke="black" stroke-width="2" d="M79.39,-37.19C96.76,-33.5 117.39,-29.12 134.55,-25.47"></path> <polygon fill="black" stroke="black" stroke-width="2" points="135.67,-28.81 144.73,-23.31 134.22,-21.97 135.67,-28.81"></polygon> <text text-anchor="middle" x="113.49" y="-37.2" font-family="Times,serif" font-size="14.00">0.33</text> </g> <!-- We&#45;&gt;saw --> <g id="edge13" class="edge">
<title>
We-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M197.88,-17.14C208.85,-17.13 221.71,-17.59 233.24,-19.2 236.76,-19.69 240.4,-20.37 244.02,-21.15"></path> <polygon fill="black" stroke="black" stroke-width="6" points="243.05,-26.32 254.01,-23.56 245.52,-16.11 243.05,-26.32"></polygon> <text text-anchor="middle" x="224.49" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<pre><code>I saw the dog
We saw a dog
I read a book
I saw a book
I saw a dog</code></pre>
<div class="cell">

</div>
<div id="fig-update" class="column-page quarto-layout-panel">
<p></p><figcaption>Figure&nbsp;1: Before and after update.</figcaption><p></p>
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-fig-responsive="true" data-file="figure/3sent.dot" data-fig-caption="before update" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 641.01 124.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-120 637.01,-120 637.01,4 -4,4"></polygon> <!-- a --> <g id="node1" class="node">
<title>
a
</title>
<ellipse fill="none" stroke="black" cx="387.05" cy="-85" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="387.05" y="-80.8" font-family="Times,serif" font-size="14.00">a</text> </g> <!-- book --> <g id="node2" class="node">
<title>
book
</title>
<ellipse fill="none" stroke="black" cx="497.9" cy="-98" rx="30.2" ry="18"></ellipse> <text text-anchor="middle" x="497.9" y="-93.8" font-family="Times,serif" font-size="14.00">book</text> </g> <!-- a&#45;&gt;book --> <g id="edge1" class="edge">
<title>
a-&gt;book
</title>
<path fill="none" stroke="black" stroke-width="3" d="M413.84,-88.08C426.89,-89.64 443.02,-91.57 457.57,-93.3"></path> <polygon fill="black" stroke="black" stroke-width="3" points="457.49,-96.82 467.83,-94.53 458.32,-89.87 457.49,-96.82"></polygon> <text text-anchor="middle" x="440.8" y="-96.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- dog --> <g id="node3" class="node">
<title>
dog
</title>
<ellipse fill="none" stroke="black" cx="497.9" cy="-44" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="497.9" y="-39.8" font-family="Times,serif" font-size="14.00">dog</text> </g> <!-- a&#45;&gt;dog --> <g id="edge2" class="edge">
<title>
a-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="3" d="M410.87,-76.41C426.39,-70.56 447.18,-62.73 464.43,-56.23"></path> <polygon fill="black" stroke="black" stroke-width="3" points="465.98,-59.38 474.11,-52.58 463.52,-52.83 465.98,-59.38"></polygon> <text text-anchor="middle" x="440.8" y="-72.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- END --> <g id="node4" class="node">
<title>
END
</title>
<ellipse fill="none" stroke="black" cx="602.13" cy="-71" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="602.13" y="-66.8" font-family="Times,serif" font-size="14.00">END</text> </g> <!-- book&#45;&gt;END --> <g id="edge3" class="edge">
<title>
book-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M526.03,-90.84C537.6,-87.78 551.3,-84.16 563.81,-80.86"></path> <polygon fill="black" stroke="black" stroke-width="6" points="565.19,-85.92 573.52,-78.29 562.51,-75.77 565.19,-85.92"></polygon> <text text-anchor="middle" x="549.75" y="-89.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- dog&#45;&gt;END --> <g id="edge4" class="edge">
<title>
dog-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M523.38,-50.47C535.44,-53.65 550.23,-57.56 563.66,-61.1"></path> <polygon fill="black" stroke="black" stroke-width="6" points="562.59,-66.25 573.6,-63.73 565.27,-56.1 562.59,-66.25"></polygon> <text text-anchor="middle" x="549.75" y="-62.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- I --> <g id="node5" class="node">
<title>
I
</title>
<ellipse fill="none" stroke="black" cx="170.74" cy="-72" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="170.74" y="-67.8" font-family="Times,serif" font-size="14.00">I</text> </g> <!-- read --> <g id="node6" class="node">
<title>
read
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-98" rx="27.81" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-93.8" font-family="Times,serif" font-size="14.00">read</text> </g> <!-- I&#45;&gt;read --> <g id="edge5" class="edge">
<title>
I-&gt;read
</title>
<path fill="none" stroke="black" stroke-width="3" d="M196.36,-78.03C210.1,-81.39 227.44,-85.64 242.6,-89.35"></path> <polygon fill="black" stroke="black" stroke-width="3" points="242.12,-92.84 252.67,-91.82 243.79,-86.04 242.12,-92.84"></polygon> <text text-anchor="middle" x="224.49" y="-90.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- saw --> <g id="node7" class="node">
<title>
saw
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-31" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-26.8" font-family="Times,serif" font-size="14.00">saw</text> </g> <!-- I&#45;&gt;saw --> <g id="edge6" class="edge">
<title>
I-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="3" d="M194.51,-63.2C209.34,-57.48 228.93,-49.91 245.38,-43.56"></path> <polygon fill="black" stroke="black" stroke-width="3" points="247.09,-46.65 255.16,-39.78 244.57,-40.12 247.09,-46.65"></polygon> <text text-anchor="middle" x="224.49" y="-58.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- read&#45;&gt;a --> <g id="edge7" class="edge">
<title>
read-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="6" d="M306.13,-94.79C319.37,-93.17 335.64,-91.17 350.03,-89.41"></path> <polygon fill="black" stroke="black" stroke-width="6" points="350.82,-94.6 360.11,-88.18 349.54,-84.18 350.82,-94.6"></polygon> <text text-anchor="middle" x="333.3" y="-96.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- saw&#45;&gt;a --> <g id="edge8" class="edge">
<title>
saw-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="3" d="M300.87,-41.67C316.57,-49.66 338.28,-60.7 355.85,-69.64"></path> <polygon fill="black" stroke="black" stroke-width="3" points="354.62,-72.94 365.12,-74.35 357.79,-66.7 354.62,-72.94"></polygon> <text text-anchor="middle" x="333.3" y="-65.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- the --> <g id="node8" class="node">
<title>
the
</title>
<ellipse fill="none" stroke="black" cx="387.05" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="387.05" y="-13.8" font-family="Times,serif" font-size="14.00">the</text> </g> <!-- saw&#45;&gt;the --> <g id="edge9" class="edge">
<title>
saw-&gt;the
</title>
<path fill="none" stroke="black" stroke-width="3" d="M303.78,-23.56C310.44,-21.8 317.72,-20.15 324.55,-19.2 332.65,-18.07 341.42,-17.5 349.72,-17.27"></path> <polygon fill="black" stroke="black" stroke-width="3" points="349.95,-20.77 359.9,-17.14 349.86,-13.77 349.95,-20.77"></polygon> <text text-anchor="middle" x="333.3" y="-24.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- the&#45;&gt;dog --> <g id="edge12" class="edge">
<title>
the-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M414.14,-15.88C425.21,-15.65 438.17,-16.28 449.55,-19.2 456.04,-20.86 462.63,-23.56 468.75,-26.58"></path> <polygon fill="black" stroke="black" stroke-width="6" points="466.61,-31.39 477.91,-31.48 471.57,-22.13 466.61,-31.39"></polygon> <text text-anchor="middle" x="440.8" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- START --> <g id="node9" class="node">
<title>
START
</title>
<ellipse fill="none" stroke="black" cx="41.62" cy="-45" rx="41.74" ry="18"></ellipse> <text text-anchor="middle" x="41.62" y="-40.8" font-family="Times,serif" font-size="14.00">START</text> </g> <!-- START&#45;&gt;I --> <g id="edge10" class="edge">
<title>
START-&gt;I
</title>
<path fill="none" stroke="black" stroke-width="4" d="M79.39,-52.81C96.76,-56.5 117.39,-60.88 134.55,-64.53"></path> <polygon fill="black" stroke="black" stroke-width="4" points="134.22,-68.03 144.73,-66.69 135.67,-61.19 134.22,-68.03"></polygon> <text text-anchor="middle" x="113.49" y="-66.2" font-family="Times,serif" font-size="14.00">0.67</text> </g> <!-- We --> <g id="node10" class="node">
<title>
We
</title>
<ellipse fill="none" stroke="black" cx="170.74" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="170.74" y="-13.8" font-family="Times,serif" font-size="14.00">We</text> </g> <!-- START&#45;&gt;We --> <g id="edge11" class="edge">
<title>
START-&gt;We
</title>
<path fill="none" stroke="black" stroke-width="2" d="M79.39,-37.19C96.76,-33.5 117.39,-29.12 134.55,-25.47"></path> <polygon fill="black" stroke="black" stroke-width="2" points="135.67,-28.81 144.73,-23.31 134.22,-21.97 135.67,-28.81"></polygon> <text text-anchor="middle" x="113.49" y="-37.2" font-family="Times,serif" font-size="14.00">0.33</text> </g> <!-- We&#45;&gt;saw --> <g id="edge13" class="edge">
<title>
We-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M197.88,-17.14C208.85,-17.13 221.71,-17.59 233.24,-19.2 236.76,-19.69 240.4,-20.37 244.02,-21.15"></path> <polygon fill="black" stroke="black" stroke-width="6" points="243.05,-26.32 254.01,-23.56 245.52,-16.11 243.05,-26.32"></polygon> <text text-anchor="middle" x="224.49" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-responsive="true" data-file="figure/5sent.dot" data-fig-caption="After update" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 648.01 124.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-120 644.01,-120 644.01,4 -4,4"></polygon> <!-- a --> <g id="node1" class="node">
<title>
a
</title>
<ellipse fill="none" stroke="black" cx="394.05" cy="-85" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="394.05" y="-80.8" font-family="Times,serif" font-size="14.00">a</text> </g> <!-- book --> <g id="node2" class="node">
<title>
book
</title>
<ellipse fill="none" stroke="black" cx="504.9" cy="-98" rx="30.2" ry="18"></ellipse> <text text-anchor="middle" x="504.9" y="-93.8" font-family="Times,serif" font-size="14.00">book</text> </g> <!-- a&#45;&gt;book --> <g id="edge1" class="edge">
<title>
a-&gt;book
</title>
<path fill="none" stroke="black" stroke-width="3" d="M420.84,-88.08C433.89,-89.64 450.02,-91.57 464.57,-93.3"></path> <polygon fill="black" stroke="black" stroke-width="3" points="464.49,-96.82 474.83,-94.53 465.32,-89.87 464.49,-96.82"></polygon> <text text-anchor="middle" x="447.8" y="-96.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- dog --> <g id="node3" class="node">
<title>
dog
</title>
<ellipse fill="none" stroke="black" cx="504.9" cy="-44" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="504.9" y="-39.8" font-family="Times,serif" font-size="14.00">dog</text> </g> <!-- a&#45;&gt;dog --> <g id="edge2" class="edge">
<title>
a-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="3" d="M417.87,-76.41C433.39,-70.56 454.18,-62.73 471.43,-56.23"></path> <polygon fill="black" stroke="black" stroke-width="3" points="472.98,-59.38 481.11,-52.58 470.52,-52.83 472.98,-59.38"></polygon> <text text-anchor="middle" x="447.8" y="-72.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- END --> <g id="node4" class="node">
<title>
END
</title>
<ellipse fill="none" stroke="black" cx="609.13" cy="-71" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="609.13" y="-66.8" font-family="Times,serif" font-size="14.00">END</text> </g> <!-- book&#45;&gt;END --> <g id="edge3" class="edge">
<title>
book-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M533.03,-90.84C544.6,-87.78 558.3,-84.16 570.81,-80.86"></path> <polygon fill="black" stroke="black" stroke-width="6" points="572.19,-85.92 580.52,-78.29 569.51,-75.77 572.19,-85.92"></polygon> <text text-anchor="middle" x="556.75" y="-89.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- dog&#45;&gt;END --> <g id="edge4" class="edge">
<title>
dog-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M530.38,-50.47C542.44,-53.65 557.23,-57.56 570.66,-61.1"></path> <polygon fill="black" stroke="black" stroke-width="6" points="569.59,-66.25 580.6,-63.73 572.27,-56.1 569.59,-66.25"></polygon> <text text-anchor="middle" x="556.75" y="-62.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- I --> <g id="node5" class="node">
<title>
I
</title>
<ellipse fill="none" stroke="black" cx="163.74" cy="-72" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="163.74" y="-67.8" font-family="Times,serif" font-size="14.00">I</text> </g> <!-- read --> <g id="node6" class="node">
<title>
read
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-98" rx="27.81" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-93.8" font-family="Times,serif" font-size="14.00">read</text> </g> <!-- I&#45;&gt;read --> <g id="edge5" class="edge">
<title>
I-&gt;read
</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M189.57,-77.71C204.98,-81.25 225.03,-85.85 242.14,-89.78"></path> <polygon fill="black" stroke="black" stroke-width="1.5" points="241.81,-93.3 252.34,-92.13 243.37,-86.48 241.81,-93.3"></polygon> <text text-anchor="middle" x="220.99" y="-91.2" font-family="Times,serif" font-size="14.00">0.25</text> </g> <!-- saw --> <g id="node7" class="node">
<title>
saw
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-31" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-26.8" font-family="Times,serif" font-size="14.00">saw</text> </g> <!-- I&#45;&gt;saw --> <g id="edge6" class="edge">
<title>
I-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="4.5" d="M187.91,-63.6C204.46,-57.61 226.96,-49.46 245.31,-42.8"></path> <polygon fill="black" stroke="black" stroke-width="4.5" points="246.69,-46.49 254.75,-39.38 244.01,-39.09 246.69,-46.49"></polygon> <text text-anchor="middle" x="220.99" y="-60.2" font-family="Times,serif" font-size="14.00">0.75</text> </g> <!-- read&#45;&gt;a --> <g id="edge7" class="edge">
<title>
read-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="6" d="M306.42,-94.95C321.43,-93.23 340.4,-91.05 356.77,-89.17"></path> <polygon fill="black" stroke="black" stroke-width="6" points="357.74,-94.34 367.07,-87.98 356.54,-83.91 357.74,-94.34"></polygon> <text text-anchor="middle" x="336.8" y="-96.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- saw&#45;&gt;a --> <g id="edge8" class="edge">
<title>
saw-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="4.5" d="M301.44,-41.28C318.67,-49.5 343.03,-61.13 362.3,-70.33"></path> <polygon fill="black" stroke="black" stroke-width="4.5" points="360.86,-74 371.58,-74.75 364.25,-66.89 360.86,-74"></polygon> <text text-anchor="middle" x="336.8" y="-66.2" font-family="Times,serif" font-size="14.00">0.75</text> </g> <!-- the --> <g id="node8" class="node">
<title>
the
</title>
<ellipse fill="none" stroke="black" cx="394.05" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="394.05" y="-13.8" font-family="Times,serif" font-size="14.00">the</text> </g> <!-- saw&#45;&gt;the --> <g id="edge9" class="edge">
<title>
saw-&gt;the
</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M303.78,-23.55C310.44,-21.79 317.72,-20.15 324.55,-19.2 334.97,-17.75 346.38,-17.16 356.84,-17.01"></path> <polygon fill="black" stroke="black" stroke-width="1.5" points="356.92,-20.51 366.91,-16.99 356.9,-13.51 356.92,-20.51"></polygon> <text text-anchor="middle" x="336.8" y="-24.2" font-family="Times,serif" font-size="14.00">0.25</text> </g> <!-- the&#45;&gt;dog --> <g id="edge12" class="edge">
<title>
the-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M421.14,-15.88C432.21,-15.65 445.17,-16.28 456.55,-19.2 463.04,-20.86 469.63,-23.56 475.75,-26.58"></path> <polygon fill="black" stroke="black" stroke-width="6" points="473.61,-31.39 484.91,-31.48 478.57,-22.13 473.61,-31.39"></polygon> <text text-anchor="middle" x="447.8" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- START --> <g id="node9" class="node">
<title>
START
</title>
<ellipse fill="none" stroke="black" cx="41.62" cy="-45" rx="41.74" ry="18"></ellipse> <text text-anchor="middle" x="41.62" y="-40.8" font-family="Times,serif" font-size="14.00">START</text> </g> <!-- START&#45;&gt;I --> <g id="edge10" class="edge">
<title>
START-&gt;I
</title>
<path fill="none" stroke="black" stroke-width="4.8" d="M78.99,-53.17C94.47,-56.65 112.46,-60.7 127.79,-64.14"></path> <polygon fill="black" stroke="black" stroke-width="4.8" points="127.23,-68.32 137.91,-66.42 129.07,-60.13 127.23,-68.32"></polygon> <text text-anchor="middle" x="109.99" y="-65.2" font-family="Times,serif" font-size="14.00">0.8</text> </g> <!-- We --> <g id="node10" class="node">
<title>
We
</title>
<ellipse fill="none" stroke="black" cx="163.74" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="163.74" y="-13.8" font-family="Times,serif" font-size="14.00">We</text> </g> <!-- START&#45;&gt;We --> <g id="edge11" class="edge">
<title>
START-&gt;We
</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M78.99,-36.83C94.47,-33.35 112.46,-29.3 127.79,-25.86"></path> <polygon fill="black" stroke="black" stroke-width="1.2" points="128.92,-29.19 137.91,-23.58 127.38,-22.36 128.92,-29.19"></polygon> <text text-anchor="middle" x="109.99" y="-36.2" font-family="Times,serif" font-size="14.00">0.2</text> </g> <!-- We&#45;&gt;saw --> <g id="edge13" class="edge">
<title>
We-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M190.88,-16.99C203.7,-16.86 219.34,-17.27 233.24,-19.2 236.76,-19.69 240.4,-20.36 244.02,-21.14"></path> <polygon fill="black" stroke="black" stroke-width="6" points="243.06,-26.31 254.01,-23.55 245.52,-16.1 243.06,-26.31"></polygon> <text text-anchor="middle" x="220.99" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
</figure>
</div>
</section>
</section>
<section id="the-probability-of-a-sentence" class="level2">
<h2 class="anchored" data-anchor-id="the-probability-of-a-sentence">The probability of a sentence</h2>
<p>Another way to visualize the final state diagram from above is with a matrix, with the “from” words along the rows and the “to” words along the columns.</p>
<div class="cell-output-display">
<table class="table">
<colgroup>
<col style="width: 1%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">words</th>
<th style="text-align: left;">a</th>
<th style="text-align: left;">book</th>
<th style="text-align: left;">dog</th>
<th style="text-align: left;">END</th>
<th style="text-align: left;">I</th>
<th style="text-align: left;">read</th>
<th style="text-align: left;">saw</th>
<th style="text-align: left;">the</th>
<th style="text-align: left;">We</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">read</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">saw</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">START</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.8</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
</tbody>
</table>
</div>
<p>There is a non-zero number for every arrow in the state diagram. Every <em>0</em> value in the table represents a possible bigram that wasn’t observed (so, no arrow in the diagram).</p>
<p>Given these bigram probabilities we estimated from the corpus <em>and</em> our assumption that we can approximate the probability of whole sentences with smaller ngram probabilities, we can estimate the probability of a new sentence like so:</p>
<ul>
<li>We saw the dog.</li>
</ul>
<style>
    .bigrampath{
    }
    .bg1{
      color: #440154; 
    }
    .bg2{
      color: #3b528b; 
    }
    .bg3{
      color: #21918c;
    }
    .bg4{
      color: #5ec962;
    }
    .bg5{
      color: #fde725;
    }
    .bigrampath tr:nth-child(7) td:nth-child(10){background : #440154; color: white;}
    .bigrampath tr:nth-child(9) td:nth-child(8) {background : #3b528b; color: white;}
    .bigrampath tr:nth-child(6) td:nth-child(9) {background : #21918c; color: white;}
    .bigrampath tr:nth-child(8) td:nth-child(4) {background : #5ec962; }
    .bigrampath tr:nth-child(3) td:nth-child(5) {background : #fde725; }
</style>
<p><span class="bg1">P(We | &lt;START&gt;)</span> <span class="math inline">\(\times\)</span> <span class="bg2">P(saw | We)</span> <span class="math inline">\(\times\)</span> <span class="bg3">P(the | saw)</span> <span class="math inline">\(\times\)</span> <span class="bg4">P(dog | saw)</span> <span class="math inline">\(\times\)</span> <span class="bg5">P(&lt;END&gt; | dog)</span></p>
<div class="bigrampath">
<div class="cell-output-display">
<table class="table">
<colgroup>
<col style="width: 1%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">words</th>
<th style="text-align: left;">a</th>
<th style="text-align: left;">book</th>
<th style="text-align: left;">dog</th>
<th style="text-align: left;">END</th>
<th style="text-align: left;">I</th>
<th style="text-align: left;">read</th>
<th style="text-align: left;">saw</th>
<th style="text-align: left;">the</th>
<th style="text-align: left;">We</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">read</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">saw</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">START</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.8</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can re-write the probability formula above like so:</p>
<p><span class="math display">\[
P(s) = \prod_{i=1}^n P(w_i|w_{i-1})
\]</span></p>
<p>We can also plug in the probabilities of these bigrams into the formula to get our estimated probility of the sentence.</p>
<p><span class="math display">\[
P(s) = 0.2 \times 1 \times 1\times 0.25 \times 1 = 0.05
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Log probabilities
</div>
</div>
<div class="callout-body-container callout-body">
<p>Once you start multiplying probabilities, you’re going to get smaller and smaller numbers.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">this</th>
<th style="text-align: left;"></th>
<th style="text-align: right;">equals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">=</td>
<td style="text-align: right;">0.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.5 × 0.5</td>
<td style="text-align: left;">=</td>
<td style="text-align: right;">0.250</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5 × 0.5 × 0.5</td>
<td style="text-align: left;">=</td>
<td style="text-align: right;">0.125</td>
</tr>
<tr class="even">
<td style="text-align: left;">0.5 × 0.5 × 0.5 × 0.5</td>
<td style="text-align: left;">=</td>
<td style="text-align: right;">0.062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">0.5 × 0.5 × 0.5 × 0.5 × 0.5</td>
<td style="text-align: left;">=</td>
<td style="text-align: right;">0.031</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Even one very small probability (which you’ll get sometimes) can start sending the overall estimate into infintesimally small numbers close to 0, which <a href="https://en.wikipedia.org/wiki/Arithmetic_underflow">computers may not be able to represent</a>.</p>
<p>So, it’s also common to see the log-probability (a.k.a. the log-likelihood, in this case) being calculated instead. The way logarithms work, you add together values that you would have multiplied in the probability space.</p>
<p><span class="math display">\[
\log(P(\text{We saw the dog}))=\log(P(\text{We | &lt;START&gt;})) +  \log(P(\text{saw | We}))+\dots
\]</span></p>
<p><span class="math display">\[
\log(P(s)) = \sum_{i=1}^n \log(P(w_i|w_{i-1}))
\]</span></p>
<p><span class="math display">\[
\log(P(s)) = -1.609438 + 0 + 0 + -1.386294 + 0 = -2.995732
\]</span></p>
</div>
</div>
<section id="larger-ngrams" class="level3">
<h3 class="anchored" data-anchor-id="larger-ngrams">Larger ngrams</h3>
<p>Language models that take a larger window of adjacent words (3, or 4 grams) work in the same way, and are more “accurate” but are harder to visualize.</p>
<div class="cell-output-display">
<table class="table">
<colgroup>
<col style="width: 4%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">prev</th>
<th style="text-align: left;">a</th>
<th style="text-align: left;">book</th>
<th style="text-align: left;">dog</th>
<th style="text-align: left;">END</th>
<th style="text-align: left;">read</th>
<th style="text-align: left;">saw</th>
<th style="text-align: left;">the</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">a_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">a_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a_read</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">a_saw</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">a_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">I_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">I_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">I_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">I_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">I_read</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">I_saw</td>
<td style="text-align: left;">0.666666666666667</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.333333333333333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">I_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">read_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">read_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">read_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">read_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">read_read</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">read_saw</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">read_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">read_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">saw_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.333333333333333</td>
<td style="text-align: left;">0.666666666666667</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">saw_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">saw_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">saw_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">saw_read</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">saw_saw</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">saw_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">saw_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">START_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">START_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">START_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">START_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">START_read</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">START_saw</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">START_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">START_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">the_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">the_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">the_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">the_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">the_read</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">the_saw</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">the_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">the_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">We_a</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">We_book</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">We_dog</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">We_I</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">We_read</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">We_saw</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">We_the</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">We_We</td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
<td style="text-align: left;"><span style="color:grey">0</span></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="generating-text" class="level2">
<h2 class="anchored" data-anchor-id="generating-text">Generating text</h2>
<p>Once we’ve estimated all of these transition probabilities, we can turn them around to <em>generate</em> text, if we want. Let’s take the final bigram “model” we had from before:</p>
<div class="cell" data-fig-responsive="true" data-file="figure/5sent.dot">
<div class="cell-output-display">
<div>
<p>
<svg width="672" height="480" viewbox="0.00 0.00 648.01 124.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 120)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-120 644.01,-120 644.01,4 -4,4"></polygon> <!-- a --> <g id="node1" class="node">
<title>
a
</title>
<ellipse fill="none" stroke="black" cx="394.05" cy="-85" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="394.05" y="-80.8" font-family="Times,serif" font-size="14.00">a</text> </g> <!-- book --> <g id="node2" class="node">
<title>
book
</title>
<ellipse fill="none" stroke="black" cx="504.9" cy="-98" rx="30.2" ry="18"></ellipse> <text text-anchor="middle" x="504.9" y="-93.8" font-family="Times,serif" font-size="14.00">book</text> </g> <!-- a&#45;&gt;book --> <g id="edge1" class="edge">
<title>
a-&gt;book
</title>
<path fill="none" stroke="black" stroke-width="3" d="M420.84,-88.08C433.89,-89.64 450.02,-91.57 464.57,-93.3"></path> <polygon fill="black" stroke="black" stroke-width="3" points="464.49,-96.82 474.83,-94.53 465.32,-89.87 464.49,-96.82"></polygon> <text text-anchor="middle" x="447.8" y="-96.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- dog --> <g id="node3" class="node">
<title>
dog
</title>
<ellipse fill="none" stroke="black" cx="504.9" cy="-44" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="504.9" y="-39.8" font-family="Times,serif" font-size="14.00">dog</text> </g> <!-- a&#45;&gt;dog --> <g id="edge2" class="edge">
<title>
a-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="3" d="M417.87,-76.41C433.39,-70.56 454.18,-62.73 471.43,-56.23"></path> <polygon fill="black" stroke="black" stroke-width="3" points="472.98,-59.38 481.11,-52.58 470.52,-52.83 472.98,-59.38"></polygon> <text text-anchor="middle" x="447.8" y="-72.2" font-family="Times,serif" font-size="14.00">0.5</text> </g> <!-- END --> <g id="node4" class="node">
<title>
END
</title>
<ellipse fill="none" stroke="black" cx="609.13" cy="-71" rx="30.77" ry="18"></ellipse> <text text-anchor="middle" x="609.13" y="-66.8" font-family="Times,serif" font-size="14.00">END</text> </g> <!-- book&#45;&gt;END --> <g id="edge3" class="edge">
<title>
book-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M533.03,-90.84C544.6,-87.78 558.3,-84.16 570.81,-80.86"></path> <polygon fill="black" stroke="black" stroke-width="6" points="572.19,-85.92 580.52,-78.29 569.51,-75.77 572.19,-85.92"></polygon> <text text-anchor="middle" x="556.75" y="-89.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- dog&#45;&gt;END --> <g id="edge4" class="edge">
<title>
dog-&gt;END
</title>
<path fill="none" stroke="black" stroke-width="6" d="M530.38,-50.47C542.44,-53.65 557.23,-57.56 570.66,-61.1"></path> <polygon fill="black" stroke="black" stroke-width="6" points="569.59,-66.25 580.6,-63.73 572.27,-56.1 569.59,-66.25"></polygon> <text text-anchor="middle" x="556.75" y="-62.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- I --> <g id="node5" class="node">
<title>
I
</title>
<ellipse fill="none" stroke="black" cx="163.74" cy="-72" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="163.74" y="-67.8" font-family="Times,serif" font-size="14.00">I</text> </g> <!-- read --> <g id="node6" class="node">
<title>
read
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-98" rx="27.81" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-93.8" font-family="Times,serif" font-size="14.00">read</text> </g> <!-- I&#45;&gt;read --> <g id="edge5" class="edge">
<title>
I-&gt;read
</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M189.57,-77.71C204.98,-81.25 225.03,-85.85 242.14,-89.78"></path> <polygon fill="black" stroke="black" stroke-width="1.5" points="241.81,-93.3 252.34,-92.13 243.37,-86.48 241.81,-93.3"></polygon> <text text-anchor="middle" x="220.99" y="-91.2" font-family="Times,serif" font-size="14.00">0.25</text> </g> <!-- saw --> <g id="node7" class="node">
<title>
saw
</title>
<ellipse fill="none" stroke="black" cx="278.89" cy="-31" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="278.89" y="-26.8" font-family="Times,serif" font-size="14.00">saw</text> </g> <!-- I&#45;&gt;saw --> <g id="edge6" class="edge">
<title>
I-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="4.5" d="M187.91,-63.6C204.46,-57.61 226.96,-49.46 245.31,-42.8"></path> <polygon fill="black" stroke="black" stroke-width="4.5" points="246.69,-46.49 254.75,-39.38 244.01,-39.09 246.69,-46.49"></polygon> <text text-anchor="middle" x="220.99" y="-60.2" font-family="Times,serif" font-size="14.00">0.75</text> </g> <!-- read&#45;&gt;a --> <g id="edge7" class="edge">
<title>
read-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="6" d="M306.42,-94.95C321.43,-93.23 340.4,-91.05 356.77,-89.17"></path> <polygon fill="black" stroke="black" stroke-width="6" points="357.74,-94.34 367.07,-87.98 356.54,-83.91 357.74,-94.34"></polygon> <text text-anchor="middle" x="336.8" y="-96.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- saw&#45;&gt;a --> <g id="edge8" class="edge">
<title>
saw-&gt;a
</title>
<path fill="none" stroke="black" stroke-width="4.5" d="M301.44,-41.28C318.67,-49.5 343.03,-61.13 362.3,-70.33"></path> <polygon fill="black" stroke="black" stroke-width="4.5" points="360.86,-74 371.58,-74.75 364.25,-66.89 360.86,-74"></polygon> <text text-anchor="middle" x="336.8" y="-66.2" font-family="Times,serif" font-size="14.00">0.75</text> </g> <!-- the --> <g id="node8" class="node">
<title>
the
</title>
<ellipse fill="none" stroke="black" cx="394.05" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="394.05" y="-13.8" font-family="Times,serif" font-size="14.00">the</text> </g> <!-- saw&#45;&gt;the --> <g id="edge9" class="edge">
<title>
saw-&gt;the
</title>
<path fill="none" stroke="black" stroke-width="1.5" d="M303.78,-23.55C310.44,-21.79 317.72,-20.15 324.55,-19.2 334.97,-17.75 346.38,-17.16 356.84,-17.01"></path> <polygon fill="black" stroke="black" stroke-width="1.5" points="356.92,-20.51 366.91,-16.99 356.9,-13.51 356.92,-20.51"></polygon> <text text-anchor="middle" x="336.8" y="-24.2" font-family="Times,serif" font-size="14.00">0.25</text> </g> <!-- the&#45;&gt;dog --> <g id="edge12" class="edge">
<title>
the-&gt;dog
</title>
<path fill="none" stroke="black" stroke-width="6" d="M421.14,-15.88C432.21,-15.65 445.17,-16.28 456.55,-19.2 463.04,-20.86 469.63,-23.56 475.75,-26.58"></path> <polygon fill="black" stroke="black" stroke-width="6" points="473.61,-31.39 484.91,-31.48 478.57,-22.13 473.61,-31.39"></polygon> <text text-anchor="middle" x="447.8" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> <!-- START --> <g id="node9" class="node">
<title>
START
</title>
<ellipse fill="none" stroke="black" cx="41.62" cy="-45" rx="41.74" ry="18"></ellipse> <text text-anchor="middle" x="41.62" y="-40.8" font-family="Times,serif" font-size="14.00">START</text> </g> <!-- START&#45;&gt;I --> <g id="edge10" class="edge">
<title>
START-&gt;I
</title>
<path fill="none" stroke="black" stroke-width="4.8" d="M78.99,-53.17C94.47,-56.65 112.46,-60.7 127.79,-64.14"></path> <polygon fill="black" stroke="black" stroke-width="4.8" points="127.23,-68.32 137.91,-66.42 129.07,-60.13 127.23,-68.32"></polygon> <text text-anchor="middle" x="109.99" y="-65.2" font-family="Times,serif" font-size="14.00">0.8</text> </g> <!-- We --> <g id="node10" class="node">
<title>
We
</title>
<ellipse fill="none" stroke="black" cx="163.74" cy="-18" rx="27" ry="18"></ellipse> <text text-anchor="middle" x="163.74" y="-13.8" font-family="Times,serif" font-size="14.00">We</text> </g> <!-- START&#45;&gt;We --> <g id="edge11" class="edge">
<title>
START-&gt;We
</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M78.99,-36.83C94.47,-33.35 112.46,-29.3 127.79,-25.86"></path> <polygon fill="black" stroke="black" stroke-width="1.2" points="128.92,-29.19 137.91,-23.58 127.38,-22.36 128.92,-29.19"></polygon> <text text-anchor="middle" x="109.99" y="-36.2" font-family="Times,serif" font-size="14.00">0.2</text> </g> <!-- We&#45;&gt;saw --> <g id="edge13" class="edge">
<title>
We-&gt;saw
</title>
<path fill="none" stroke="black" stroke-width="6" d="M190.88,-16.99C203.7,-16.86 219.34,-17.27 233.24,-19.2 236.76,-19.69 240.4,-20.36 244.02,-21.14"></path> <polygon fill="black" stroke="black" stroke-width="6" points="243.06,-26.31 254.01,-23.55 245.52,-16.1 243.06,-26.31"></polygon> <text text-anchor="middle" x="220.99" y="-24.2" font-family="Times,serif" font-size="14.00">1</text> </g> </g>
</svg>
</p>
</div>
</div>
</div>
<p>If we start at <code>&lt;START&gt;</code> and roll some dice, there’s a 80% chance we’ll move to <code>I</code> and a 20% chance we’ll move to <code>We</code>.</p>
<ul>
<li><p><code>&lt;START&gt;</code></p>
<ul>
<li><p><i class="fa-solid fa-dice-d20" aria-hidden="true"></i> = 26</p></li>
<li><p><code>We</code></p>
<ul>
<li><p><i class="fa-solid fa-dice-d20" aria-hidden="true"></i> = 67</p></li>
<li><p><code>saw</code></p>
<ul>
<li><p><i class="fa-solid fa-dice-d20" aria-hidden="true"></i> = 67</p></li>
<li><p><code>a</code></p>
<ul>
<li><p><i class="fa-solid fa-dice-d20" aria-hidden="true"></i> = 67</p></li>
<li><p><code>dog</code></p>
<ul>
<li><p><i class="fa-solid fa-dice-d20" aria-hidden="true"></i> = 23</p></li>
<li><p><code>&lt;END&gt;</code></p></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Our bigram model on our boring corpus generates boring results. But here’s the output of a tigram model estimated over <em>Frankenstein</em>.</p>
<div class="cell">

</div>
<details>
<summary>
Details
</summary>
<p>The version of the data I’m working with here hasn’t been sentence-ized (so no <code>&lt;START&gt;</code> or <code>&lt;BEGIN&gt;</code> tags), and has also had punctuation stripped out (<a href="https://juliasilge.github.io/tidytext/reference/unnest_tokens.html">see function here</a>). So after estimating the trigram probabilities, seed the generator by sampling over all trigrams, then progress by sampling over the distribution of <span class="math inline">\(P(w_i|w_{i-2}w_{i-1})\)</span>.</p>
</details>
<div class="cell">
<details>
<summary>Trigram R Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>frank <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(word) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nextw1 =</span> <span class="fu">lead</span>(word),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">nextw2 =</span> <span class="fu">lead</span>(word, <span class="at">n =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(word, nextw1) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(word, nextw1, nextw2) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p =</span> n<span class="sc">/</span>n_tot) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p =</span> <span class="fu">mean</span>(p),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()<span class="ot">-&gt;</span>trigram</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details>
<summary>generator R Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(517)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>generate_frankenstein <span class="ot">&lt;-</span> <span class="cf">function</span>(trigram, <span class="at">n =</span> <span class="dv">100</span>){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  trigram <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">all_p =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">weight =</span> all_p)<span class="ot">-&gt;</span>init_df</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  init_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(init_df<span class="sc">$</span>word, init_df<span class="sc">$</span>nextw1, init_df<span class="sc">$</span>nextw2)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(n)){</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    hist <span class="ot">=</span> <span class="fu">rev</span>(<span class="fu">rev</span>(init_vec)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    trigram <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(word <span class="sc">==</span> hist[<span class="dv">1</span>],</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>             nextw1 <span class="sc">==</span> hist[<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">weight =</span> p) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(nextw2) <span class="ot">-&gt;</span> new_w</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      init_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(init_vec, new_w)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">str_c</span>(init_vec, <span class="at">collapse =</span> <span class="st">" "</span>))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"&gt; "</span>, <span class="fu">generate_frankenstein</span>(trigram, <span class="at">n =</span> <span class="dv">100</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<blockquote class="blockquote">
<p>morning the moon was just rising from the trees or cut in stone that guided me and above all as belonging to a hell of intense tortures such as even dante could not sacrifice the whole kind but where is he why m clerval i was impatient to arrive at great proficiency in that study is certainly unlawful that is to assure as far as others have gone tracing a secure way over the chairs clapped my hands before my eyes which obliged me to heaven for nothing contributes so much time spent in observing my friends dread a dangerous relapse alas why</p>
</blockquote>
</section>
<section id="sparsity-again" class="level2">
<h2 class="anchored" data-anchor-id="sparsity-again">Sparsity, again</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p>The rectangle represents a matrix, with the y-axis representing “from” words and the x-axis representing “to” words in Frankenstein. There <em>could</em> be a point in any location in the rectangle, representing a time that word <span class="math inline">\(w_n\)</span> followed word <span class="math inline">\(w_{n-1}\)</span>. Each point represents a cell in that matrix where <em>any</em> data was observed.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-allopenna1998" class="csl-entry" role="doc-biblioentry">
Allopenna, Paul D., James S. Magnuson, and Michael K. Tanenhaus. 1998. <span>“Tracking the Time Course of Spoken Word Recognition Using Eye Movements: Evidence for Continuous Mapping Models.”</span> <em>Journal of Memory and Language</em> 38 (4): 419–39. <a href="https://doi.org/10.1006/jmla.1997.2558">https://doi.org/10.1006/jmla.1997.2558</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Credit here to Kyle Gorman for introducing me to this example.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lectures/lem_stem/index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lemmatizing and stemming</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../lectures/ngram/01-ngram-eval.html" class="pagination-link">
        <span class="nav-page-text">ngrams - Perplexity</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
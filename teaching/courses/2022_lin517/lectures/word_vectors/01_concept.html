<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.233">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josef Fruehwald">
<meta name="dcterms.date" content="2022-10-26">

<title>Lin517: Natural Language Processing - Word Vectors - Concepts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../lectures/evaluation/index.html" rel="next">
<link href="../../lectures/word_vectors/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible">
<script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Word Vectors - Concepts</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Lin517: Natural Language Processing</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/reading/index.html" class="sidebar-item-text sidebar-link">Reading a technical paper</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/notation/index.html" class="sidebar-item-text sidebar-link">Mathematical notation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Intro</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/what_is_nlp/index.html" class="sidebar-item-text sidebar-link">What is NLP?</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Data Sparsity and Processing</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_sparsity/data_sparsity.html" class="sidebar-item-text sidebar-link">Data Sparsity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_processing/index.html" class="sidebar-item-text sidebar-link">Data processing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/data_processing/addendum.html" class="sidebar-item-text sidebar-link">Data processing – addendum</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/lem_stem/index.html" class="sidebar-item-text sidebar-link">Lemmatizing and stemming</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">ngrams</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/index.html" class="sidebar-item-text sidebar-link">ngram Language Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/01-ngram-eval.html" class="sidebar-item-text sidebar-link">ngrams - Perplexity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/ngram/02_smoothing.html" class="sidebar-item-text sidebar-link">ngram - Smoothing</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../lectures/word_vectors/index.html" class="sidebar-item-text sidebar-link">Word Vectors</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/word_vectors/01_concept.html" class="sidebar-item-text sidebar-link active">Word Vectors - Concepts</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lectures/evaluation/index.html" class="sidebar-item-text sidebar-link">Evaluating models</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">python sessions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/00_session1.html" class="sidebar-item-text sidebar-link">Starting Python</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/01_session2.html" class="sidebar-item-text sidebar-link">Lists and Dictionaries</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/02_session3.html" class="sidebar-item-text sidebar-link">Loops Etc.</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/03_session4.html" class="sidebar-item-text sidebar-link">Comprehensions and Useful Things</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../python_sessions/04_session5.html" class="sidebar-item-text sidebar-link">Making and Counting Bigrams</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#features" id="toc-features" class="nav-link active" data-scroll-target="#features">Features</a>
  <ul class="collapse">
  <li><a href="#categorical-features" id="toc-categorical-features" class="nav-link" data-scroll-target="#categorical-features">Categorical Features</a></li>
  <li><a href="#numeric-features" id="toc-numeric-features" class="nav-link" data-scroll-target="#numeric-features">Numeric Features</a></li>
  </ul></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a>
  <ul class="collapse">
  <li><a href="#the-magnitude-of-a-vector." id="toc-the-magnitude-of-a-vector." class="nav-link" data-scroll-target="#the-magnitude-of-a-vector.">The “magnitude” of a vector.</a></li>
  <li><a href="#comparing-vectors" id="toc-comparing-vectors" class="nav-link" data-scroll-target="#comparing-vectors">Comparing Vectors</a></li>
  <li><a href="#with-more-dimensions" id="toc-with-more-dimensions" class="nav-link" data-scroll-target="#with-more-dimensions">With more dimensions</a></li>
  </ul></li>
  <li><a href="#what-does-this-have-to-do-with-nlp" id="toc-what-does-this-have-to-do-with-nlp" class="nav-link" data-scroll-target="#what-does-this-have-to-do-with-nlp">What does this have to do with NLP?</a>
  <ul class="collapse">
  <li><a href="#books-in-word-count-vector-space" id="toc-books-in-word-count-vector-space" class="nav-link" data-scroll-target="#books-in-word-count-vector-space">Books in word count vector space</a></li>
  <li><a href="#the-full-vector-space" id="toc-the-full-vector-space" class="nav-link" data-scroll-target="#the-full-vector-space">The <em>full</em> vector space</a></li>
  <li><a href="#author-identification" id="toc-author-identification" class="nav-link" data-scroll-target="#author-identification">Author Identification?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Word Vectors - Concepts</h1>
  <div class="quarto-categories">
    <div class="quarto-category">word vectors</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Josef Fruehwald </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 26, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="features" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="features">Features</h2>
<section id="categorical-features" class="level3">
<h3 class="anchored" data-anchor-id="categorical-features">Categorical Features</h3>
<p>In linguistics, you’ve probably already encountered our tendency to categorize <em>things</em> using a bunch of features. For example, in Phonology we often categorize phonemes according to “distinctive features.”</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">voice</th>
<th style="text-align: center;">continuant</th>
<th style="text-align: center;">LAB</th>
<th style="text-align: center;">COR</th>
<th style="text-align: center;">DORS</th>
<th style="text-align: center;">anterior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="even">
<td>t</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="odd">
<td>k</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="even">
<td>b</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="odd">
<td>d</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="even">
<td>g</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="odd">
<td>f</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="even">
<td>s</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="odd">
<td>ʃ</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
</tr>
</tbody>
</table>
<p>More relevant to the topic of word vectors, we could do the same with semantic features and words</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">domesticated</th>
<th style="text-align: center;">feline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cat</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➕</td>
</tr>
<tr class="even">
<td>puma</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➕</td>
</tr>
<tr class="odd">
<td>dog</td>
<td style="text-align: center;">➕</td>
<td style="text-align: center;">➖</td>
</tr>
<tr class="even">
<td>wolf</td>
<td style="text-align: center;">➖</td>
<td style="text-align: center;">➖</td>
</tr>
</tbody>
</table>
</section>
<section id="numeric-features" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="numeric-features">Numeric Features</h3>
<p>Instead of using categorical values for these features, let’s use a numeric score. These represent my own subjective scores for these animals.</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">domesticated</th>
<th style="text-align: right;">feline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cat</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td>puma</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="odd">
<td>dog</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td>wolf</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
<p>The sequence of numbers associated with “cat”, [70, 100], we’ll call a “vector”. A lot of the work we’re going to do with vectors can be understood if we start with two dimensional vectors like this. We can plot each animal as a point in the [domesticated, feline] “vector space”.</p>
<div class="cell">

</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-vecpoints" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-vecpoints-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;1: four animals plotted in the domesticated/feline space</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="vectors" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="vectors">Vectors</h2>
<p>The word “vector” might conjure up ideas of “direction” for you, as it should! The way we really want to think about vectors when we’re doing word vectors is like a line with an arrow at the end, pointing at the location in “vector space” where each animal is.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-vecarrow" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-vecarrow-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;2: four animals plotted in the domesticated/feline space</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="the-magnitude-of-a-vector." class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-magnitude-of-a-vector.">The “magnitude” of a vector.</h3>
<p>We’re going to have to calculate the magnitudes of vectors, so let’s start with calculating the magnitude of the “dog” vector.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dogvec1" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-dogvec1-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;3: dog plotted in the domesticated/feline space</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The magnitude of “dog” in this vector space is the length of the line that reaches from the [0,0] point to the location of “dog”. The mathematical notation we’d use to indicate “the length of the dog vector” is <span class="math inline">\(|\text{dog}|\)</span>. We can work out the distance of the vector by thinking about it like a right triangle.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-dogvec2" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-dogvec2-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;4: dog plotted in the domesticated/feline space</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Looking at the dog vector this way, we can use the Pythagorean Theorem to get its length</p>
<p><span class="math display">\[
|\text{dog}|^2 = \text{domesticated}^2 + \text{feline}^2
\]</span></p>
<p><span class="math display">\[
|\text{dog}| = \sqrt{\text{domesticated}^2 + \text{feline}^2}
\]</span></p>
<p>I won’t go through the actual numbers here, but it turns out the magnitude of dog is 94.87.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dog <span class="op">=</span> np.array([<span class="dv">90</span>, <span class="dv">30</span>])</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>dog_mag1 <span class="op">=</span> np.sqrt(<span class="bu">sum</span>([x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> dog]))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#or</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>dog_mag2 <span class="op">=</span> np.linalg.norm(dog)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dog_mag1<span class="sc">:.2f}</span><span class="ss"> or </span><span class="sc">{</span>dog_mag2<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>94.87 or 94.87</code></pre>
</div>
</div>
<section id="in-general" class="level4">
<h4 class="anchored" data-anchor-id="in-general">In General</h4>
<p>The way things worked out for dog is how we’d calculate the magnitude of any vector of any dimensionality. You square each value, sum them up, then take the square root of that sum.</p>
<p><span class="math display">\[
|v|^2 = v_1^2 + v_2^2 + v_3^2  + \dots +v_i^2
\]</span></p>
<p><span class="math display">\[
|v|^2 = \sum_{i = 1}^nv_i^2
\]</span></p>
<p><span class="math display">\[
|v| = \sqrt{\sum_{i = 1}^nv_i^2}
\]</span></p>
</section>
</section>
<section id="comparing-vectors" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="comparing-vectors">Comparing Vectors</h3>
<p>Now, let’s compare the vectors for “cat” and “dog” in this “vector space”</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-catdog1" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-catdog1-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;5: dog and cat plotted in the domesticated/feline space</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>How should we compare the closeness of these two vectors in the vector space? What’s most common is to estimate the angle between the two, usually notated with <span class="math inline">\(\theta\)</span>, or more specifially, to get the cosine of the angle, <span class="math inline">\(\cos\theta\)</span>.</p>
<div class="cell">

</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-catdog2" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-catdog2-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;6: dog and cat plotted in the domesticated/feline space</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Where did cosine come in?? This is a bit of a throwback to trigonometry, again being related to formulas for estimating angles of triangles.</p>
<p>The specific formula to get <span class="math inline">\(\cos\theta\)</span> for dog and cat involves a “dot product”, which for dog and cat in particular goes like this <span class="math display">\[
\text{dog}\cdot \text{cat} = (\text{dog}_{\text{domesticated}}\times\text{cat}_{\text{domesticated}}) +  (\text{dog}_{\text{feline}}\times\text{cat}_{\text{feline}})
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dog <span class="op">=</span> np.array([<span class="dv">90</span>, <span class="dv">30</span>])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cat <span class="op">=</span> np.array([<span class="dv">70</span>, <span class="dv">100</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>dot1 <span class="op">=</span> <span class="bu">sum</span>([x <span class="op">*</span> y <span class="cf">for</span> x,y <span class="kw">in</span> <span class="bu">zip</span>(dog, cat)])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># or!</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>dot2 <span class="op">=</span> np.dot(dog, cat)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>dot1<span class="sc">}</span><span class="ss"> or </span><span class="sc">{</span>dot2<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9300 or 9300</code></pre>
</div>
</div>
<p>In general, the dot product of any two vectors will be</p>
<p><span class="math display">\[
a\cdot b = a_1b_1 + a_2b_2 + a_3b_3 +\dots a_ib_i
\]</span></p>
<p><span class="math display">\[
a\cdot b= \sum_{i=1}^n a_ib_i
\]</span></p>
<p>One way to think of the dot product here is if two vectors have very similar values along many dimensions, their dot product will be large. On the other hand, if they’re very different, and one had a lot of zeros where the other has large values, the dot product will be small.</p>
<p>The full formula for <span class="math inline">\(\cos\theta\)</span> normalizes the dot product by dividing it by the product the magnitude of dog and cat.</p>
<p><span class="math display">\[
\cos\theta = \frac{\text{dog}\cdot\text{cat}}{|\text{dog}||\text{cat}|}
\]</span></p>
<p>The reason why we’re dividing like this is because if the two vectors had the <em>same</em> direction, their dot product would equal multiplying their magnitudes.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-sametheta" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-sametheta-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;7: two vectors with the same <span class="math inline">\(\theta\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>big_dog <span class="op">=</span> np.array([<span class="dv">90</span>, <span class="dv">30</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>small_dog <span class="op">=</span> np.array([<span class="dv">30</span>, <span class="dv">10</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>big_dog_mag <span class="op">=</span> np.linalg.norm(big_dog)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>small_dog_mag <span class="op">=</span> np.linalg.norm(small_dog)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Product of magnitudes is </span><span class="sc">{</span>(big_dog_mag <span class="op">*</span> small_dog_mag)<span class="sc">:.0f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Product of magnitudes is 3000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>big_small_dot <span class="op">=</span> np.dot(big_dog, small_dog)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Dot produtct of vectors is </span><span class="sc">{</span>big_small_dot<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dot produtct of vectors is 3000</code></pre>
</div>
</div>
<p>Normalizing like this means that <span class="math inline">\(\cos\theta\)</span> is always going to be some number between -1 and 1, and for the vectors we’re going to be looking at, usually between 0 and 1.</p>
<p>For the actual case of dog and cat</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dog <span class="op">=</span> np.array([<span class="dv">90</span>, <span class="dv">30</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cat <span class="op">=</span> np.array([<span class="dv">70</span>, <span class="dv">100</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>dog_dot_cat <span class="op">=</span> np.dot(dog, cat)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>dog_mag <span class="op">=</span> np.linalg.norm(dog)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>cat_mag <span class="op">=</span> np.linalg.norm(cat)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>cat_dog_cos <span class="op">=</span> dog_dot_cat <span class="op">/</span> (dog_mag <span class="op">*</span> cat_mag)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The cosine similarity of dog and cat is </span><span class="sc">{</span>cat_dog_cos<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The cosine similarity of dog and cat is 0.803</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> spatial</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cat_dog_cos2 <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> spatial.distance.cosine(dog, cat)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The cosine similarity of dog and cat is </span><span class="sc">{</span>cat_dog_cos2<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The cosine similarity of dog and cat is 0.803</code></pre>
</div>
</div>
</section>
<section id="with-more-dimensions" class="level3">
<h3 class="anchored" data-anchor-id="with-more-dimensions">With more dimensions</h3>
<p>The basic principles remain the same even if we start including even more dimensions. For example, let’s say we added size to the set of features for each animal.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">animal</th>
<th style="text-align: right;">domesticated</th>
<th style="text-align: right;">feline</th>
<th style="text-align: right;">size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cat</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">puma</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dog</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">wolf</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">60</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-b36b8f6d5a5398d24030" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b36b8f6d5a5398d24030">{"x":{"visdat":{"865f71073904":["function () ","plotlyVisDat"],"865f11306f95":["function () ","data"],"865f2eda804":["function () ","data"]},"cur_data":"865f2eda804","attrs":{"865f11306f95":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"color":{},"mode":"lines","colors":"Dark2","inherit":true},"865f2eda804":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"color":{},"colors":"Dark2","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"range":[0,100],"title":"domesticated"},"yaxis":{"range":[0,100],"title":"feline"},"zaxis":{"range":[0,100],"title":"size"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,70],"y":[0,100],"z":[0,10],"mode":"lines","type":"scatter3d","name":"cat","marker":{"color":"rgba(27,158,119,1)","line":{"color":"rgba(27,158,119,1)"}},"textfont":{"color":"rgba(27,158,119,1)"},"error_y":{"color":"rgba(27,158,119,1)"},"error_x":{"color":"rgba(27,158,119,1)"},"line":{"color":"rgba(27,158,119,1)"},"frame":null},{"x":[0,90],"y":[0,30],"z":[0,30],"mode":"lines","type":"scatter3d","name":"dog","marker":{"color":"rgba(217,95,2,1)","line":{"color":"rgba(217,95,2,1)"}},"textfont":{"color":"rgba(217,95,2,1)"},"error_y":{"color":"rgba(217,95,2,1)"},"error_x":{"color":"rgba(217,95,2,1)"},"line":{"color":"rgba(217,95,2,1)"},"frame":null},{"x":[0,0],"y":[0,90],"z":[0,90],"mode":"lines","type":"scatter3d","name":"puma","marker":{"color":"rgba(117,112,179,1)","line":{"color":"rgba(117,112,179,1)"}},"textfont":{"color":"rgba(117,112,179,1)"},"error_y":{"color":"rgba(117,112,179,1)"},"error_x":{"color":"rgba(117,112,179,1)"},"line":{"color":"rgba(117,112,179,1)"},"frame":null},{"x":[0,10],"y":[0,10],"z":[0,60],"mode":"lines","type":"scatter3d","name":"wolf","marker":{"color":"rgba(231,41,138,1)","line":{"color":"rgba(231,41,138,1)"}},"textfont":{"color":"rgba(231,41,138,1)"},"error_y":{"color":"rgba(231,41,138,1)"},"error_x":{"color":"rgba(231,41,138,1)"},"line":{"color":"rgba(231,41,138,1)"},"frame":null},{"x":[70],"y":[100],"z":[10],"type":"scatter3d","mode":"markers","name":"cat","marker":{"color":"rgba(27,158,119,1)","line":{"color":"rgba(27,158,119,1)"}},"textfont":{"color":"rgba(27,158,119,1)"},"error_y":{"color":"rgba(27,158,119,1)"},"error_x":{"color":"rgba(27,158,119,1)"},"line":{"color":"rgba(27,158,119,1)"},"frame":null},{"x":[90],"y":[30],"z":[30],"type":"scatter3d","mode":"markers","name":"dog","marker":{"color":"rgba(217,95,2,1)","line":{"color":"rgba(217,95,2,1)"}},"textfont":{"color":"rgba(217,95,2,1)"},"error_y":{"color":"rgba(217,95,2,1)"},"error_x":{"color":"rgba(217,95,2,1)"},"line":{"color":"rgba(217,95,2,1)"},"frame":null},{"x":[0],"y":[90],"z":[90],"type":"scatter3d","mode":"markers","name":"puma","marker":{"color":"rgba(117,112,179,1)","line":{"color":"rgba(117,112,179,1)"}},"textfont":{"color":"rgba(117,112,179,1)"},"error_y":{"color":"rgba(117,112,179,1)"},"error_x":{"color":"rgba(117,112,179,1)"},"line":{"color":"rgba(117,112,179,1)"},"frame":null},{"x":[10],"y":[10],"z":[60],"type":"scatter3d","mode":"markers","name":"wolf","marker":{"color":"rgba(231,41,138,1)","line":{"color":"rgba(231,41,138,1)"}},"textfont":{"color":"rgba(231,41,138,1)"},"error_y":{"color":"rgba(231,41,138,1)"},"error_x":{"color":"rgba(231,41,138,1)"},"line":{"color":"rgba(231,41,138,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We can do all the same things we did before, with the same math.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dog <span class="op">=</span> np.array([<span class="dv">90</span>, <span class="dv">30</span>, <span class="dv">30</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cat <span class="op">=</span> np.array([<span class="dv">70</span>, <span class="dv">100</span>, <span class="dv">10</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>dog_mag <span class="op">=</span> np.linalg.norm(dog)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>cat_mag <span class="op">=</span> np.linalg.norm(cat)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"dog magnitude: </span><span class="sc">{</span>dog_mag<span class="sc">:.2f}</span><span class="ss">, cat magnitude: </span><span class="sc">{</span>cat_mag<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dog magnitude: 99.50, cat magnitude: 122.474</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dog_cat_cos <span class="op">=</span> np.dot(dog, cat)<span class="op">/</span>(dog_mag <span class="op">*</span> cat_mag)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"dog and cat cosine similarity: </span><span class="sc">{</span>dog_cat_cos<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dog and cat cosine similarity: 0.79</code></pre>
</div>
</div>
</section>
</section>
<section id="what-does-this-have-to-do-with-nlp" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-does-this-have-to-do-with-nlp">What does this have to do with NLP?</h2>
<p>Before we get to word, vectors, we can start talking about “document” vectors. I’ve collapsed the next few code blocks for downloading a bunch of books by Mary Shelley and Jules Verne so we can focus on the “vectors” part.</p>
<div class="cell">
<details>
<summary>a get book function</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gutenbergpy.textget</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getbook(book, outfile):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Download a book from project Gutenberg and save it </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">  to the specified outfile</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"Downloading Project Gutenberg ID </span><span class="sc">{</span>book<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  raw_book <span class="op">=</span> gutenbergpy.textget.get_text_by_id(book)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  clean_book <span class="op">=</span> gutenbergpy.textget.strip_headers(raw_book)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">not</span> outfile:</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    outfile <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>book<span class="sc">}</span><span class="ss">.txt'</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Saving book as </span><span class="sc">{</span>outfile<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">with</span> <span class="bu">open</span>(outfile, <span class="st">'wb'</span>) <span class="im">as</span> <span class="bu">file</span>:</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.write(clean_book)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Project Gutenberg information</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mary_shelley_ids <span class="op">=</span> [<span class="dv">84</span>, <span class="dv">15238</span>, <span class="dv">18247</span>, <span class="dv">64329</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mary_shelley_files <span class="op">=</span>  [<span class="ss">f"gen/books/shelley/</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">.txt"</span> <span class="cf">for</span> x <span class="kw">in</span> mary_shelley_ids]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>mary_shelley_titles <span class="op">=</span> [<span class="st">"Frankenstein"</span>, <span class="st">"Mathilda"</span>, <span class="st">"The Last Man"</span>, <span class="st">"Falkner"</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>jules_verne_ids <span class="op">=</span> [<span class="dv">103</span>, <span class="dv">164</span>, <span class="dv">1268</span>, <span class="dv">18857</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>jules_verne_files <span class="op">=</span> [<span class="ss">f"gen/books/verne/</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">.txt"</span> <span class="cf">for</span> x <span class="kw">in</span> jules_verne_ids]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>jules_verne_titles <span class="op">=</span> [<span class="st">"80days"</span>, <span class="st">"ThousandLeagues"</span>, <span class="st">"MysteriousIsland"</span>, <span class="st">"CenterOfTheEarth"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> [getbook(x, <span class="ss">f"gen/books/shelley/</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">.txt"</span>) <span class="cf">for</span> x <span class="kw">in</span> mary_shelley_ids]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>foo <span class="op">=</span> [getbook(x, <span class="ss">f"gen/books/verne/</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">.txt"</span>) <span class="cf">for</span> x <span class="kw">in</span> jules_verne_ids]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’re going to very quickly tokenize these books into words, and then get just unigram counts for each book</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> RegexpTokenizer</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_unigram_counts(path):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Given a path, generate a counter dictionary of unigrams</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> f.read()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  text <span class="op">=</span> text.replace(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">" "</span>).lower()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  unigrams <span class="op">=</span> RegexpTokenizer(<span class="vs">r"\w+"</span>).tokenize(text)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> Counter(unigrams)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>shelley_words <span class="op">=</span> {k:get_unigram_counts(v) </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">zip</span>(mary_shelley_titles, mary_shelley_files)}</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>verne_words <span class="op">=</span> {k:get_unigram_counts(v) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">zip</span>(jules_verne_titles, jules_verne_files)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So now, <code>shelley_words</code> is a dictionary with keys for each book:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>shelley_words.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dict_keys(['Frankenstein', 'Mathilda', 'The Last Man', 'Falkner'])</code></pre>
</div>
</div>
<p>And the value associated with each key is the unigram count of word in that book:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>shelley_words[<span class="st">"Frankenstein"</span>].most_common(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[('the', 4195), ('and', 2976), ('i', 2846), ('of', 2642), ('to', 2089), ('my', 1776), ('a', 1391), ('in', 1128), ('was', 1021), ('that', 1018)]</code></pre>
</div>
</div>
<section id="books-in-word-count-vector-space" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="books-in-word-count-vector-space">Books in word count vector space</h3>
<p>Before were were classifying animals in the “feline” and “domesticated” vector space. What if we classified These book by Mary Shelley and Jules Verne in the “monster” and “sea” vector space. We’ll just compare them in terms of how many times the word “monster” and “sea” appeared in each of their books.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_term_count(book_dict, term):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">    return a list of the number of times a term has appeared</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">    in a book</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  out <span class="op">=</span> [book_dict[book][term] <span class="cf">for</span> book <span class="kw">in</span> book_dict]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>monster <span class="op">=</span> [<span class="st">"monster"</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>          get_term_count(shelley_words, <span class="st">"monster"</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>          get_term_count(verne_words, <span class="st">"monster"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sea  <span class="op">=</span> [<span class="st">"sea"</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>          get_term_count(shelley_words, <span class="st">"sea"</span>) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>          get_term_count(verne_words, <span class="st">"sea"</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">book</th>
<th style="text-align: right;">monster</th>
<th style="text-align: right;">sea</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Frankenstein</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mathilda</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Last Man</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">118</td>
</tr>
<tr class="even">
<td style="text-align: left;">Falkner</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80days</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">ThousandLeagues</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">357</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MysteriousIsland</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">277</td>
</tr>
<tr class="even">
<td style="text-align: left;">CenterOfTheEarth</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">122</td>
</tr>
</tbody>
</table>
<p>So, in the “monster”, “sea” vector space, we’d say <em>Frankenstein</em> has a vector of [31, 31], and <em>Around the World in 80 Days</em> has a vector of [0, 52]. We can make a vector plot for these books in much the same way we did for the animals in the “feline” and “domesticated” vector space.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell page-columns page-full">
<div class="cell-output-display page-columns page-full">
<div id="fig-monster-vec" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="01_concept_files/figure-html/fig-monster-vec-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;8: Selected Mary Shelley and Jules Verne novels in the <code>monster</code>,<code>sea</code> vector space</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can also do all of the same vector computations we did before. In <a href="#fig-monster-vec">Figure&nbsp;8</a>, <em>Frankenstein</em> and <em>Around the World in 80 Days</em> seem to have the largest angle between them. Let’s calculate it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>frank <span class="op">=</span> [shelley_words[<span class="st">"Frankenstein"</span>][word] <span class="cf">for</span> word <span class="kw">in</span> [<span class="st">"monster"</span>, <span class="st">"sea"</span>]]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>eighty <span class="op">=</span> [verne_words[<span class="st">"80days"</span>][word] <span class="cf">for</span> word <span class="kw">in</span> [<span class="st">"monster"</span>, <span class="st">"sea"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[31, 34]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(eighty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 52]</code></pre>
</div>
</div>
<p>Let’s get their cosine similarity the fast way with <code>scipy.spatial.distance.cosine()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scipy already imported</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-</span> spatial.distance.cosine(frank, eighty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7389558439133294</code></pre>
</div>
</div>
<p>The novels <em>Mathilda</em> and <em>Journey to the Center of the Earth</em>, on the other hand, look like they have almost identical angles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mathilda <span class="op">=</span> [shelley_words[<span class="st">"Mathilda"</span>][word] <span class="cf">for</span> word <span class="kw">in</span> [<span class="st">"monster"</span>, <span class="st">"sea"</span>]]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>center <span class="op">=</span> [verne_words[<span class="st">"CenterOfTheEarth"</span>][word] <span class="cf">for</span> word <span class="kw">in</span> [<span class="st">"monster"</span>, <span class="st">"sea"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mathilda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[3, 20]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[19, 122]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-</span> spatial.distance.cosine(mathilda, center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9999842826707133</code></pre>
</div>
</div>
<p>Here’s table of every novel’s cosine similarity from the other in “monster”, “sea” vector space,</p>
<div class="cell">

</div>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">Fankenstein</th>
<th style="text-align: left;">Mathilda</th>
<th style="text-align: left;">EightyDay</th>
<th style="text-align: right;">CenterOfTheEarth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fankenstein</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.83</td>
<td style="text-align: left;">0.74</td>
<td style="text-align: right;">0.83</td>
</tr>
<tr class="even">
<td>Mathilda</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.99</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td>EightyDay</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.99</td>
</tr>
<tr class="even">
<td>CenterOfTheEarth</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</section>
<section id="the-full-vector-space" class="level3">
<h3 class="anchored" data-anchor-id="the-full-vector-space">The <em>full</em> vector space</h3>
<p>Of course, we are not limited to calculating cosine similarity on just <em>two</em> dimensions. We could use the <em>whole</em> shared vocabulary between two novels to compute the cosine similarity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>shared_vocab <span class="op">=</span> <span class="bu">set</span>(<span class="bu">list</span>(shelley_words[<span class="st">"Frankenstein"</span>].keys()) <span class="op">+</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                   <span class="bu">list</span>(verne_words[<span class="st">"80days"</span>].keys()))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total dimensions: </span><span class="sc">{</span><span class="bu">len</span>(shared_vocab)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total dimensions: 10544</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>frankenstein_vector <span class="op">=</span> [shelley_words[<span class="st">"Frankenstein"</span>][v] <span class="cf">for</span> v <span class="kw">in</span> shared_vocab]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>eighty_vector <span class="op">=</span> [verne_words[<span class="st">"80days"</span>][v] <span class="cf">for</span> v <span class="kw">in</span> shared_vocab]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-</span> spatial.distance.cosine(frankenstein_vector, eighty_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8759771803390622</code></pre>
</div>
</div>
</section>
<section id="author-identification" class="level3">
<h3 class="anchored" data-anchor-id="author-identification">Author Identification?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mystery1 <span class="op">=</span> getbook(<span class="dv">6447</span>, outfile<span class="op">=</span><span class="st">"gen/books/shelley/6447.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading Project Gutenberg ID 6447</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mystery <span class="op">=</span> get_unigram_counts(<span class="st">"gen/books/shelley/6447.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_dist(book1, book2):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">    given unigram counts from two books</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">    return the cosine distance</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  shared_vocab <span class="op">=</span> <span class="bu">set</span>(<span class="bu">list</span>(book1.keys()) <span class="op">+</span> <span class="bu">list</span>(book2.keys()))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  book1_vec <span class="op">=</span> [book1[v] <span class="cf">for</span> v <span class="kw">in</span> shared_vocab]</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  book2_vec <span class="op">=</span> [book2[v] <span class="cf">for</span> v <span class="kw">in</span> shared_vocab]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  sim <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>spatial.distance.cosine(book1_vec, book2_vec)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>shelley_dist <span class="op">=</span> [get_dist(shelley_words[book], mystery) <span class="cf">for</span> book <span class="kw">in</span> shelley_words]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>np.mean(shelley_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9314257403627573</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>verne_dist <span class="op">=</span> [get_dist(verne_words[book], mystery) <span class="cf">for</span> book <span class="kw">in</span> verne_words]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>np.mean(verne_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9376880437662538</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lectures/word_vectors/index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Word Vectors</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../lectures/evaluation/index.html" class="pagination-link">
        <span class="nav-page-text">Evaluating models</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>